<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–ß–∏—Ç–∞—Ç–µ–ª—å ‚Äî –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ —Ü–∏—Ç–∞—Ç</title>
    
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Meta –¥–ª—è PWA -->
    <meta name="theme-color" content="#d4af37">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="–ß–∏—Ç–∞—Ç–µ–ª—å">
    
    <!-- –ò–∫–æ–Ω–∫–∏ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—É—Ç–∏) -->
    <link rel="apple-touch-icon" href="./assets/icon-192.svg">
    <link rel="icon" type="image/svg+xml" sizes="192x192" href="./assets/icon-192.svg">
    <link rel="icon" type="image/svg+xml" sizes="32x32" href="./assets/icon-32.svg">
    <link rel="icon" type="image/svg+xml" sizes="16x16" href="./assets/icon-16.svg">
    <link rel="manifest" href="./manifest.json">
    
    <!-- –û–ë–ù–û–í–õ–ï–ù–ù–´–ï –°–¢–ò–õ–ò –í –ü–û–†–Ø–î–ö–ï –ü–†–ò–û–†–ò–¢–ï–¢–ê -->
    <link rel="stylesheet" href="./css/main.css">
    <link rel="stylesheet" href="./css/telegram-themes.css">    <!-- –ù–û–í–û–ï: –ü–æ–ª–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è —Ç–µ–º -->
    <link rel="stylesheet" href="./css/anna-pages.css">         <!-- –°—Ç–∏–ª–∏ –≤ –¥—É—Ö–µ annabusel.org -->
    <link rel="stylesheet" href="./css/navigation.css">         <!-- –ö—Ä—É–ø–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <link rel="stylesheet" href="./css/components.css">         <!-- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã -->
    <link rel="stylesheet" href="./css/diary.css">              <!-- –î–Ω–µ–≤–Ω–∏–∫ —Å AI –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π —Ç–µ–º -->
    <link rel="stylesheet" href="./css/mobile.css">             <!-- –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π -->
</head>
<body>
    <!-- Loader -->
    <div id="loader" class="loader">
        <div class="loader-spinner"></div>
        <p>–ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∞—à –¥–Ω–µ–≤–Ω–∏–∫ —Ü–∏—Ç–∞—Ç...</p>
    </div>

    <!-- Main App Container -->
    <div id="app" class="app-container" style="display: none;">
        
        <!-- –ù–û–í–ê–Ø –ù–ê–í–ò–ì–ê–¶–ò–Ø - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è navigation.css -->
        <nav class="navigation" id="navigation">
            <button class="nav-item active" data-page="home">
                <span class="nav-icon">üè†</span>
                <span class="nav-label">–ì–ª–∞–≤–Ω–∞—è</span>
            </button>
            <button class="nav-item" data-page="catalog">
                <span class="nav-icon">üõí</span>
                <span class="nav-label">–ö–∞—Ç–∞–ª–æ–≥</span>
            </button>
            <button class="nav-item" data-page="diary">
                <span class="nav-icon">üìñ</span>
                <span class="nav-label">–î–Ω–µ–≤–Ω–∏–∫</span>
            </button>
            <button class="nav-item" data-page="achievements">
                <span class="nav-icon">üèÜ</span>
                <span class="nav-label">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</span>
            </button>
            <button class="nav-item" data-page="settings">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span class="nav-label">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            </button>
        </nav>

        <!-- Page: Home - –ù–û–í–´–ô –ú–ò–ù–ò–ú–ê–õ–ò–°–¢–ò–ß–ù–´–ô –î–ò–ó–ê–ô–ù -->
        <div id="page-home" class="page active page-container">
            <div class="home-minimal">
                <div class="home-date" id="home-date">–°–µ–≥–æ–¥–Ω—è 20 –∏—é–ª—è</div>
                
                <div class="main-metric">
                    <div class="main-metric-number" id="total-quotes">25</div>
                    <div class="main-metric-label">–º—ã—Å–ª–µ–π –∑–∞–ø–∏—Å–∞–Ω–æ ‚ú®</div>
                </div>

                <button class="main-action-button" onclick="app.showPage('diary')">
                    ‚úçÔ∏è –ó–∞–ø–∏—Å–∞—Ç—å –º—ã—Å–ª—å —Å–µ–π—á–∞—Å
                </button>

                <div class="compact-stats">
                    <div class="compact-stat">
                        <div class="compact-stat-number" id="week-quotes">3</div>
                        <div class="compact-stat-label">–∑–∞ –Ω–µ–¥–µ–ª—é</div>
                    </div>
                    <div class="compact-stat">
                        <div class="compact-stat-number" id="streak-days">5</div>
                        <div class="compact-stat-label">–¥–Ω–µ–π –ø–æ–¥—Ä—è–¥</div>
                    </div>
                    <div class="compact-stat">
                        <div class="compact-stat-number">üìà</div>
                        <div class="compact-stat-label">—Ä–∞—Å—Ç–µ—Ç–µ</div>
                    </div>
                </div>

                <div class="motivational-block">
                    "–í–∞—à–∏ –∑–∞–ø–∏—Å–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≥–ª—É–±–∏–Ω—É –º—ã—à–ª–µ–Ω–∏—è"
                </div>
            </div>
        </div>

        <!-- Page: Catalog - –ù–û–í–ê–Ø –°–¢–†–ê–ù–ò–¶–ê -->
        <div id="page-catalog" class="page page-container">
            <div class="catalog-header">
                <h1 class="anna-h1">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –≤–∞—Å</h1>
                <p class="personal-recommendation">–ù–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–∏—Ö –∑–∞–ø–∏—Å–µ–π –æ —Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–∏</p>
            </div>

            <div class="promo-codes-compact">
                üéÅ –í–∞—à–∏ —Å–∫–∏–¥–∫–∏: 
                <span class="promo-code" onclick="window.catalogManager.copyPromoCode('READER20')">READER20</span> (20%) ‚Ä¢ 
                <span class="promo-code" onclick="window.catalogManager.copyPromoCode('PHIL15')">PHIL15</span> (15%)
            </div>

            <div id="books-list" class="books-list">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è -->
            </div>

            <div class="categories-grid">
                <a href="#" class="category-item" onclick="window.catalogManager.filterByCategory('psychology'); return false;">
                    <span class="category-icon">üß†</span>
                    <div class="category-name">–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è</div>
                    <div class="category-count">(12)</div>
                </a>
                <a href="#" class="category-item" onclick="window.catalogManager.filterByCategory('selfdevelopment'); return false;">
                    <span class="category-icon">üöÄ</span>
                    <div class="category-name">–°–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ</div>
                    <div class="category-count">(8)</div>
                </a>
                <a href="#" class="category-item" onclick="window.catalogManager.filterByCategory('relationships'); return false;">
                    <span class="category-icon">üíù</span>
                    <div class="category-name">–û—Ç–Ω–æ—à–µ–Ω–∏—è</div>
                    <div class="category-count">(6)</div>
                </a>
            </div>
        </div>

        <!-- Page: Diary - –°–û–•–†–ê–ù–Ø–ï–ú –ö–ê–ö –ï–°–¢–¨, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è diary.css -->
        <div id="page-diary" class="page">
            <div class="diary-container">
                <div class="diary-header">
                    <h1 class="diary-title">–ú–æ–π –¥–Ω–µ–≤–Ω–∏–∫ —Ü–∏—Ç–∞—Ç</h1>
                    <p class="diary-subtitle">–ú–µ—Å—Ç–æ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º—É–¥—Ä—ã—Ö –º—ã—Å–ª–µ–π –∏ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è</p>
                </div>

                <div class="book-container" id="book-container">
                    <!-- –ü–µ—Ä–µ–ø–ª–µ—Ç –∫–Ω–∏–≥–∏ -->
                    <div class="book-spine"></div>
                    
                    <!-- –¶–µ–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
                    <div class="book-page">
                        <div class="page-content" id="page-content">
                            <div class="page-loading">–ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–Ω–µ–≤–Ω–∏–∫–∞...</div>
                        </div>
                        <!-- –ö–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π –∫—Ä–∞–π –¥–ª—è –ø–µ—Ä–µ–ª–∏—Å—Ç—ã–≤–∞–Ω–∏—è -->
                        <div class="page-corner"></div>
                    </div>
                </div>

                <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å —Ç–æ—á–∫–∞–º–∏ -->
                <div class="page-navigation">
                    <button class="nav-btn" id="prev-page">
                        ‚óÄ –ù–∞–∑–∞–¥
                    </button>
                    
                    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ç–æ—á–µ–∫ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    <div class="page-dots">
                        <!-- –¢–æ—á–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è JS -->
                    </div>
                    
                    <div class="page-indicator" id="page-indicator">
                        –°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 –∏–∑ 1
                    </div>
                    
                    <button class="nav-btn" id="next-page">
                        –í–ø–µ—Ä–µ–¥ ‚ñ∂
                    </button>
                </div>
            </div>
        </div>

        <!-- Page: Achievements - –ù–û–í–´–ô –ö–û–ú–ü–ê–ö–¢–ù–´–ô –î–ò–ó–ê–ô–ù -->
        <div id="page-achievements" class="page page-container">
            <h1 class="anna-h1">–í–∞—à–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h1>
            
            <div class="achievements-compact">
                <div class="current-status">
                    –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π —á–∏—Ç–∞—Ç–µ–ª—å
                    <div class="status-streak">5 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥</div>
                </div>
                
                <div class="badges-grid">
                    <div class="badge-item earned">
                        <span class="badge-icon">üèÜ</span>
                        <div class="badge-name">–ü–µ—Ä–≤–∞—è –º—ã—Å–ª—å</div>
                    </div>
                    <div class="badge-item earned">
                        <span class="badge-icon">ü•à</span>
                        <div class="badge-name">–ù–µ–¥–µ–ª—è</div>
                    </div>
                    <div class="badge-item locked">
                        <span class="badge-icon">üîí</span>
                        <div class="badge-name">–§–∏–ª–æ—Å–æ—Ñ</div>
                    </div>
                </div>
                
                <div class="monthly-challenge">
                    <div class="challenge-title">–ú–∞—Ä—Ç: –§–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏—è</div>
                    <div class="challenge-progress">
                        <span>–ü—Ä–æ–≥—Ä–µ—Å—Å:</span>
                        <span class="progress-fraction">5/12</span>
                    </div>
                    <div class="anna-progress">
                        <div class="anna-progress-bar" style="width: 42%"></div>
                    </div>
                </div>
            </div>

            <button class="anna-button">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è</button>
        </div>

        <!-- Page: Settings - –ù–û–í–´–ô –ü–†–û–°–¢–û–ô –î–ò–ó–ê–ô–ù -->
        <div id="page-settings" class="page page-container">
            <div class="profile-compact">
                <div class="profile-header">
                    <div class="profile-name" id="user-name">–ú–∞—Ä–∏–Ω–∞</div>
                    <div class="profile-status">–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π —á–∏—Ç–∞—Ç–µ–ª—å</div>
                </div>

                <div class="key-metrics">
                    <div class="key-metric">
                        <div class="metric-number" id="settings-total-quotes">25</div>
                        <div class="metric-label">—Ü–∏—Ç–∞—Ç</div>
                    </div>
                    <div class="key-metric">
                        <div class="metric-number" id="settings-record">12</div>
                        <div class="metric-label">—Ä–µ–∫–æ—Ä–¥</div>
                    </div>
                    <div class="key-metric">
                        <div class="metric-number" id="settings-authors">7</div>
                        <div class="metric-label">–∞–≤—Ç–æ—Ä–æ–≤</div>
                    </div>
                </div>

                <div class="recent-badges">
                    <span class="recent-badge">üèÜ</span>
                    <span class="recent-badge">ü•à</span>
                    <span class="recent-badge">üîí</span>
                </div>

                <div class="profile-actions">
                    <button class="profile-action">
                        <span class="profile-action-icon">üìä</span>
                        –ì–æ—Ç–æ–≤ –æ—Ç—á–µ—Ç –∑–∞ –Ω–µ–¥–µ–ª—é
                    </button>
                    <button class="profile-action">
                        <span class="profile-action-icon">‚úèÔ∏è</span>
                        –ò–∑–º–µ–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ
                    </button>
                </div>
            </div>

            <div class="settings-simple">
                <div class="settings-section">
                    <h3>–ê–∫–∫–∞—É–Ω—Ç</h3>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label">üìß Email</div>
                            <div class="settings-item-value">marina@example.com</div>
                        </div>
                        <button class="settings-item-action">–∏–∑–º–µ–Ω–∏—Ç—å</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label">üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</div>
                            <div class="settings-item-value">–í–∫–ª—é—á–µ–Ω—ã</div>
                        </div>
                        <div class="toggle-switch active"></div>
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label">‚è∞ –í—Ä–µ–º—è</div>
                            <div class="settings-item-value">9:00 –∏ 19:00</div>
                        </div>
                        <button class="settings-item-action">–∏–∑–º–µ–Ω–∏—Ç—å</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</h3>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label">üí¨ –°–≤—è–∑–∞—Ç—å—Å—è —Å –ê–Ω–Ω–æ–π</div>
                        </div>
                        <button class="settings-item-action">–Ω–∞–ø–∏—Å–∞—Ç—å</button>
                    </div>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label">‚ùì –ü–æ–º–æ—â—å</div>
                        </div>
                        <button class="settings-item-action">–æ—Ç–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h3>
                    <div class="settings-item">
                        <div class="settings-item-info">
                            <div class="settings-item-label">üìñ Reader Bot</div>
                            <div class="settings-item-value">v2.0 (—Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç–µ–º)</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <!-- AI Analysis Modal - –ù–û–í–û–ï -->
    <div id="ai-modal-overlay" class="modal-overlay" style="display: none;">
        <div class="ai-analysis-modal">
            <div class="modal-header">
                <h3 class="modal-title">–ê–Ω–∞–ª–∏–∑ –≤–∞—à–µ–π –º—ã—Å–ª–∏</h3>
                <button class="modal-close" onclick="app.closeAIModal()">√ó</button>
            </div>
            <div class="ai-analysis-content" id="ai-analysis-content">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            </div>
            <div class="book-recommendation" id="book-recommendation" style="display: none;">
                <h4>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –æ—Ç –ê–Ω–Ω—ã:</h4>
                <div id="recommended-book">
                    <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–Ω–∏–≥–∏ -->
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Overlay -->
    <div id="modal-overlay" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div id="modal-body" class="modal-body">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            </div>
            <div class="modal-actions">
                <button class="anna-button secondary" onclick="app.closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="./js/telegram-v2.js"></script>              <!-- –ù–û–í–û–ï: TelegramManager v2.0 -->
    <script src="./js/api.js"></script>
    <script src="./js/catalog.js"></script>              
    <script src="./js/diary.js"></script>
    <script src="./js/app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./service-worker.js')
                .then(registration => console.log('SW registered:', registration))
                .catch(error => console.log('SW registration failed:', error));
        }
    </script>

    <!-- App Initialization -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –ù–û–í–û–ï: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App v2.0 —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ç–µ–º
            if (window.TelegramManager) {
                const userData = window.TelegramManager.init();
                console.log('TelegramManager v2.0 initialized:', userData);
                
                // –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–º—ã
                window.TelegramManager.on('onThemeChange', (themeParams, colorScheme) => {
                    console.log('Theme changed:', colorScheme, themeParams);
                    // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç–µ–º—ã
                });
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            if (window.ReaderApp) {
                window.app = new ReaderApp();
                window.app.init();
            }
            
            // –°–∫—Ä—ã—Ç–∏–µ loader –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
            setTimeout(() => {
                document.getElementById('loader').style.display = 'none';
                document.getElementById('app').style.display = 'block';
                
                // –ù–û–í–û–ï: –õ–æ–≥–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–º–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
                if (window.TelegramManager) {
                    const themeInfo = window.TelegramManager.getCurrentTheme();
                    console.log('Current theme on startup:', themeInfo);
                }
            }, 1000);
        });
    </script>
</body>
</html>