<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–ß–∏—Ç–∞—Ç–µ–ª—å ‚Äî –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ —Ü–∏—Ç–∞—Ç</title>
    
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- Meta –¥–ª—è PWA -->
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="–ß–∏—Ç–∞—Ç–µ–ª—å">
    
    <!-- –ò–∫–æ–Ω–∫–∏ -->
    <link rel="apple-touch-icon" href="./assets/icon-192.png">
    <link rel="icon" type="image/png" sizes="192x192" href="./assets/icon-192.png">
    <link rel="manifest" href="./manifest.json">
    
    <!-- –°—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="./css/main.css">
    <link rel="stylesheet" href="./css/mobile.css">
    <link rel="stylesheet" href="./css/components.css">
</head>
<body>
    <!-- Loader -->
    <div id="loader" class="loader">
        <div class="loader-spinner"></div>
        <p>–ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∞—à –¥–Ω–µ–≤–Ω–∏–∫ —Ü–∏—Ç–∞—Ç...</p>
    </div>

    <!-- Main App Container -->
    <div id="app" class="app-container" style="display: none;">
        
        <!-- Navigation -->
        <nav class="bottom-nav" id="navigation">
            <button class="nav-item active" data-page="home">
                <span class="nav-icon">üè†</span>
                <span class="nav-label">–ì–ª–∞–≤–Ω–∞—è</span>
            </button>
            <button class="nav-item" data-page="add-quote">
                <span class="nav-icon">üìù</span>
                <span class="nav-label">–î–æ–±–∞–≤–∏—Ç—å</span>
            </button>
            <button class="nav-item" data-page="reports">
                <span class="nav-icon">üìä</span>
                <span class="nav-label">–û—Ç—á–µ—Ç—ã</span>
            </button>
            <button class="nav-item" data-page="achievements">
                <span class="nav-icon">üèÜ</span>
                <span class="nav-label">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</span>
            </button>
            <button class="nav-item" data-page="settings">
                <span class="nav-icon">‚öôÔ∏è</span>
                <span class="nav-label">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
            </button>
        </nav>

        <!-- Page: Home -->
        <div id="page-home" class="page active">
            <header class="page-header">
                <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h1>
                <p class="user-greeting">–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ —Ü–∏—Ç–∞—Ç</p>
            </header>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üìö</div>
                    <div class="stat-content">
                        <div class="stat-number" id="total-quotes">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ —Ü–∏—Ç–∞—Ç</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚ú®</div>
                    <div class="stat-content">
                        <div class="stat-number" id="week-quotes">0</div>
                        <div class="stat-label">–ó–∞ –Ω–µ–¥–µ–ª—é</div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üî•</div>
                    <div class="stat-content">
                        <div class="stat-number" id="streak-days">0</div>
                        <div class="stat-label">–î–Ω–µ–π –ø–æ–¥—Ä—è–¥</div>
                    </div>
                </div>
            </div>

            <!-- Quick Add -->
            <div class="quick-add-section">
                <h2>–ë—ã—Å—Ç—Ä–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ</h2>
                <form id="quick-add-form" class="quick-add-form">
                    <textarea 
                        id="quick-quote-text" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ —Ü–∏—Ç–∞—Ç—É –∏–ª–∏ –º—ã—Å–ª—å..."
                        rows="3"
                        maxlength="500"
                    ></textarea>
                    <input 
                        type="text" 
                        id="quick-quote-author" 
                        placeholder="–ê–≤—Ç–æ—Ä (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"
                        maxlength="100"
                    >
                    <button type="submit" class="btn-primary">
                        <span class="btn-icon">üíæ</span>
                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                </form>
            </div>

            <!-- Recent Quotes -->
            <div class="recent-quotes-section">
                <h2>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ü–∏—Ç–∞—Ç—ã</h2>
                <div id="recent-quotes-list" class="quotes-list">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è -->
                </div>
                <button class="btn-secondary" onclick="app.showPage('add-quote')">
                    –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Ü–∏—Ç–∞—Ç—ã
                </button>
            </div>
        </div>

        <!-- Page: Add Quote -->
        <div id="page-add-quote" class="page">
            <header class="page-header">
                <h1>–î–æ–±–∞–≤–∏—Ç—å —Ü–∏—Ç–∞—Ç—É</h1>
                <p>–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤–∞–∂–Ω—É—é –º—ã—Å–ª—å –∏–ª–∏ —Ü–∏—Ç–∞—Ç—É</p>
            </header>

            <form id="add-quote-form" class="quote-form">
                <div class="form-group">
                    <label for="quote-text">–¢–µ–∫—Å—Ç —Ü–∏—Ç–∞—Ç—ã *</label>
                    <textarea 
                        id="quote-text" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ —Ü–∏—Ç–∞—Ç—É –∏–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –º—ã—Å–ª—å..."
                        rows="5"
                        required
                        maxlength="1000"
                    ></textarea>
                    <div class="char-counter">
                        <span id="quote-char-count">0</span>/1000
                    </div>
                </div>

                <div class="form-group">
                    <label for="quote-author">–ê–≤—Ç–æ—Ä</label>
                    <input 
                        type="text" 
                        id="quote-author" 
                        placeholder="–ò–º—è –∞–≤—Ç–æ—Ä–∞ (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º—ã—Å–ª–µ–π)"
                        maxlength="100"
                    >
                </div>

                <div class="form-group">
                    <label for="quote-source">–ò—Å—Ç–æ—á–Ω–∏–∫</label>
                    <input 
                        type="text" 
                        id="quote-source" 
                        placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏, —Å—Ç–∞—Ç—å–∏ –∏–ª–∏ –¥—Ä—É–≥–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞"
                        maxlength="200"
                    >
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="app.showPage('home')">
                        –û—Ç–º–µ–Ω–∞
                    </button>
                    <button type="submit" class="btn-primary">
                        <span class="btn-icon">üîç</span>
                        –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
                    </button>
                </div>
            </form>

            <!-- AI Analysis Results -->
            <div id="ai-analysis-result" class="ai-analysis-section" style="display: none;">
                <h3>ü§ñ –ê–Ω–∞–ª–∏–∑ –æ—Ç –ò–ò</h3>
                <div id="ai-analysis-content" class="ai-content">
                    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ -->
                </div>
            </div>
        </div>

        <!-- Page: Reports -->
        <div id="page-reports" class="page">
            <header class="page-header">
                <h1>–û—Ç—á–µ—Ç—ã</h1>
                <p>–í–∞—à–∏ –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –∏ –º–µ—Å—è—á–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏</p>
            </header>

            <!-- Report Tabs -->
            <div class="tab-navigation">
                <button class="tab-btn active" data-tab="weekly">–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ</button>
                <button class="tab-btn" data-tab="monthly">–ú–µ—Å—è—á–Ω—ã–µ</button>
            </div>

            <!-- Weekly Reports -->
            <div id="weekly-reports" class="tab-content active">
                <div id="weekly-reports-list" class="reports-list">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è -->
                </div>
            </div>

            <!-- Monthly Reports -->
            <div id="monthly-reports" class="tab-content">
                <div id="monthly-reports-list" class="reports-list">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è -->
                </div>
            </div>
        </div>

        <!-- Page: Achievements -->
        <div id="page-achievements" class="page">
            <header class="page-header">
                <h1>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h1>
                <p>–í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ –Ω–∞–≥—Ä–∞–¥—ã</p>
            </header>

            <!-- Achievement Categories -->
            <div class="achievement-categories">
                <button class="category-btn active" data-category="all">–í—Å–µ</button>
                <button class="category-btn" data-category="quotes">–¶–∏—Ç–∞—Ç—ã</button>
                <button class="category-btn" data-category="streak">–°–µ—Ä–∏–∏</button>
                <button class="category-btn" data-category="reading">–ß—Ç–µ–Ω–∏–µ</button>
            </div>

            <!-- Achievements Grid -->
            <div id="achievements-grid" class="achievements-grid">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è -->
            </div>
        </div>

        <!-- Page: Settings -->
        <div id="page-settings" class="page">
            <header class="page-header">
                <h1>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h1>
                <p>–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º</p>
            </header>

            <!-- User Profile -->
            <div class="profile-section">
                <div class="profile-card">
                    <div class="profile-avatar" id="user-avatar">
                        üë§
                    </div>
                    <div class="profile-info">
                        <h3 id="user-name">–ó–∞–≥—Ä—É–∑–∫–∞...</h3>
                        <p id="user-username">@username</p>
                    </div>
                </div>
            </div>

            <!-- Settings Groups -->
            <div class="settings-groups">
                <div class="settings-group">
                    <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <div class="setting-item">
                        <span>–í—Å–µ–≥–æ —Ü–∏—Ç–∞—Ç</span>
                        <span id="settings-total-quotes">0</span>
                    </div>
                    <div class="setting-item">
                        <span>–î–Ω–µ–π –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</span>
                        <span id="settings-days-active">0</span>
                    </div>
                    <div class="setting-item">
                        <span>–õ—é–±–∏–º–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è</span>
                        <span id="settings-fav-category">‚Äî</span>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h3>
                    <div class="setting-item">
                        <span>–í–µ—Ä—Å–∏—è</span>
                        <span>1.0.0</span>
                    </div>
                    <div class="setting-item">
                        <span>–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</span>
                        <span>–ê–Ω–Ω–∞ –ë—É—Å–µ–ª</span>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="settings-actions">
                <button class="btn-secondary" onclick="app.exportData()">
                    üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
                </button>
                <button class="btn-secondary" onclick="app.showSupport()">
                    üí¨ –°–≤—è–∑–∞—Ç—å—Å—è —Å –ê–Ω–Ω–æ–π
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Modal Overlay -->
    <div id="modal-overlay" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div id="modal-body" class="modal-body">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" onclick="app.closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Scripts - –£–ë–ò–†–ê–ï–ú ES6 –ú–û–î–£–õ–ò, –í–û–ó–í–†–ê–©–ê–ï–ú –û–ë–´–ß–ù–´–ï -->
    <script src="./js/telegram.js"></script>
    <script src="./js/api.js"></script>
    <script src="./js/app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./service-worker.js')
                .then(registration => console.log('SW registered:', registration))
                .catch(error => console.log('SW registration failed:', error));
        }
    </script>

    <!-- App Initialization -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
            if (window.TelegramManager) {
                window.TelegramManager.init();
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            if (window.ReaderApp) {
                window.app = new ReaderApp();
                window.app.init();
            }
            
            // –°–∫—Ä—ã—Ç–∏–µ loader –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
            setTimeout(() => {
                document.getElementById('loader').style.display = 'none';
                document.getElementById('app').style.display = 'block';
            }, 1000);
        });
    </script>
</body>
</html>
