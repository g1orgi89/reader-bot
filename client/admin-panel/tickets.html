<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé´ –û–±—Ä–∞—â–µ–Ω–∏—è - –ß–∏—Ç–∞—Ç–µ–ª—å –ê–¥–º–∏–Ω</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/tickets.css">
    <meta name="description" content="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ '–ß–∏—Ç–∞—Ç–µ–ª—å' - AI –ø–æ–º–æ—â–Ω–∏–∫ –ê–Ω–Ω—ã –ë—É—Å–µ–ª">
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —à—Ä–∏—Ñ—Ç–æ–≤ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Crimson+Text:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- –¢–æ–Ω–∫–∞—è –∫–Ω–∏–∂–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—á–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü -->
    <div class="reader-bg-animation reader-bg-subtle" id="reader-matrix"></div>
    
    <div class="admin-layout">
        <!-- Header -->
        <header class="admin-header">
            <div class="logo-container">
                <div class="logo-icon">üìñ</div>
                <h1>–ß–∏—Ç–∞—Ç–µ–ª—å</h1>
                <span class="logo-subtitle">–û–±—Ä–∞—â–µ–Ω–∏—è</span>
            </div>
            
            <nav class="main-nav">
                <ul>
                    <li><a href="index.html">üìä –î–∞—à–±–æ—Ä–¥</a></li>
                    <li><a href="users.html">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a></li>
                    <li><a href="quotes.html">üìù –¶–∏—Ç–∞—Ç—ã</a></li>
                    <li><a href="reports.html">üìà –û—Ç—á–µ—Ç—ã</a></li>
                    <li><a href="knowledge.html">üìö –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π</a></li>
                    <li><a href="tickets.html" class="active">üé´ –û–±—Ä–∞—â–µ–Ω–∏—è</a></li>
                    <li><a href="prompts.html">üí≠ –ü—Ä–æ–º–ø—Ç—ã</a></li>
                </ul>
            </nav>
            
            <div class="user-menu">
                <span id="admin-username">–ê–Ω–Ω–∞ –ë—É—Å–µ–ª</span>
                <button id="logout-btn" class="btn btn-text">–í—ã—Ö–æ–¥</button>
            </div>
        </header>
        
        <!-- Main content -->
        <main class="admin-content tickets-content">
            <div class="tickets-header">
                <h2>üé´ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –û–±—Ä–∞—â–µ–Ω–∏—è–º–∏ –ß–∏—Ç–∞—Ç–µ–ª–µ–π</h2>
                <div class="tickets-actions">
                    <div class="filter-group">
                        <select id="status-filter" class="select-glow">
                            <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                            <option value="open" selected>–û—Ç–∫—Ä—ã—Ç—ã–µ</option>
                            <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                            <option value="resolved">–†–µ—à–µ–Ω–Ω—ã–µ</option>
                            <option value="closed">–ó–∞–∫—Ä—ã—Ç—ã–µ</option>
                        </select>
                        
                        <select id="priority-filter" class="select-glow">
                            <option value="all">–í—Å–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã</option>
                            <option value="low">–ù–∏–∑–∫–∏–π</option>
                            <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                            <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                            <option value="urgent">–°—Ä–æ—á–Ω—ã–π</option>
                        </select>
                        
                        <input type="text" id="search-tickets" placeholder="üîç –ü–æ–∏—Å–∫ –æ–±—Ä–∞—â–µ–Ω–∏–π..." class="search-input">
                    </div>
                    
                    <button id="refresh-tickets" class="btn btn-secondary btn-glow">
                        <span class="btn-text">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</span>
                    </button>
                </div>
            </div>
            
            <!-- Tickets list -->
            <div class="tickets-container glow-card">
                <div class="table-container">
                    <div class="empty-state" id="empty-state" style="display: none;">
                        <div class="empty-state-icon">üé´</div>
                        <h3>–ü–æ–∫–∞ –Ω–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏–π –æ—Ç —á–∏—Ç–∞—Ç–µ–ª–µ–π</h3>
                        <p>–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞–¥–∞–¥—É—Ç —Å–ª–æ–∂–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã, –æ–Ω–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</p>
                        <div class="empty-help">
                            <p>üí° <strong>–ö–∞–∫ —Å–æ–∑–¥–∞—é—Ç—Å—è –æ–±—Ä–∞—â–µ–Ω–∏—è:</strong></p>
                            <ul>
                                <li>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–¥–∞–µ—Ç —Å–ª–æ–∂–Ω—ã–π –ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å</li>
                                <li>–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏</li>
                                <li>–°–æ–∑–¥–∞–µ—Ç—Å—è –æ–±—Ä–∞—â–µ–Ω–∏–µ –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ê–Ω–Ω—ã</li>
                            </ul>
                        </div>
                    </div>
                    
                    <table class="data-table" id="tickets-table">
                        <thead>
                            <tr>
                                <th class="col-id">ID</th>
                                <th class="col-subject">–¢–µ–º–∞</th>
                                <th class="col-status">–°—Ç–∞—Ç—É—Å</th>
                                <th class="col-priority">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</th>
                                <th class="col-user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                                <th class="col-created">–°–æ–∑–¥–∞–Ω</th>
                                <th class="col-updated">–û–±–Ω–æ–≤–ª–µ–Ω</th>
                                <th class="col-actions">–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-loading">
                                <td colspan="8">üìö –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—Ä–∞—â–µ–Ω–∏–π...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Pagination -->
                <div class="pagination-container">
                    <div class="pagination-info">
                        –ü–æ–∫–∞–∑–∞–Ω–æ <span id="pagination-range">0-0</span> –∏–∑ <span id="pagination-total">0</span> –æ–±—Ä–∞—â–µ–Ω–∏–π
                    </div>
                    <div class="pagination-controls">
                        <button id="prev-page" class="btn btn-icon btn-secondary" disabled>
                            ‚Üê –ù–∞–∑–∞–¥
                        </button>
                        <span id="pagination-current">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1</span>
                        <button id="next-page" class="btn btn-icon btn-secondary" disabled>
                            –í–ø–µ—Ä–µ–¥ ‚Üí
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Ticket detail view -->
            <div class="ticket-detail-overlay" id="ticket-detail-overlay">
                <div class="ticket-detail-container glow-card">
                    <div class="ticket-detail-header">
                        <h3>üé´ –î–µ—Ç–∞–ª–∏ –û–±—Ä–∞—â–µ–Ω–∏—è</h3>
                        <button id="close-ticket-detail" class="btn btn-icon btn-text">√ó</button>
                    </div>
                    
                    <div class="ticket-detail-content">
                        <div class="ticket-info">
                            <div class="ticket-id">
                                <label>ID –æ–±—Ä–∞—â–µ–Ω–∏—è:</label>
                                <div class="ticket-id-container">
                                    <span id="detail-ticket-id" class="ticket-id-full"></span>
                                    <button id="copy-ticket-id" class="btn btn-icon btn-copy" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å ID">
                                        üìã
                                    </button>
                                </div>
                            </div>
                            
                            <div class="ticket-status">
                                <label>–°—Ç–∞—Ç—É—Å:</label>
                                <select id="detail-ticket-status" class="select-glow">
                                    <option value="open">–û—Ç–∫—Ä—ã—Ç</option>
                                    <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
                                    <option value="resolved">–†–µ—à–µ–Ω</option>
                                    <option value="closed">–ó–∞–∫—Ä—ã—Ç</option>
                                </select>
                            </div>
                            
                            <div class="ticket-priority">
                                <label>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:</label>
                                <select id="detail-ticket-priority" class="select-glow">
                                    <option value="low">–ù–∏–∑–∫–∏–π</option>
                                    <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                                    <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                                    <option value="urgent">–°—Ä–æ—á–Ω—ã–π</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="ticket-subject">
                            <label>–¢–µ–º–∞:</label>
                            <span id="detail-ticket-subject"></span>
                        </div>
                        
                        <div class="ticket-user-info">
                            <label>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</label>
                            <div class="user-info-container">
                                <div class="user-name">
                                    <span class="user-label">–ò–º—è:</span>
                                    <span id="detail-ticket-user-name"></span>
                                </div>
                                <div class="user-username">
                                    <span class="user-label">Telegram:</span>
                                    <span id="detail-ticket-username"></span>
                                </div>
                                <div class="user-email" id="detail-ticket-email-container">
                                    <span class="user-label">Email:</span>
                                    <span id="detail-ticket-email" class="user-email-value"></span>
                                    <button id="copy-user-email" class="btn btn-icon btn-copy" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å email">
                                        üìß
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="ticket-dates">
                            <div>
                                <label>–°–æ–∑–¥–∞–Ω–æ:</label>
                                <span id="detail-ticket-created"></span>
                            </div>
                            <div>
                                <label>–û–±–Ω–æ–≤–ª–µ–Ω–æ:</label>
                                <span id="detail-ticket-updated"></span>
                            </div>
                        </div>
                        
                        <div class="ticket-message">
                            <label>–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:</label>
                            <div id="detail-ticket-message" class="message-content"></div>
                        </div>
                        
                        <div class="ticket-conversation">
                            <label>–ò—Å—Ç–æ—Ä–∏—è –æ–±—â–µ–Ω–∏—è —Å –±–æ—Ç–æ–º:</label>
                            <div id="detail-ticket-conversation" class="conversation-container">
                                üìö –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞...
                            </div>
                        </div>
                        
                        <div class="ticket-resolution" id="resolution-container">
                            <label for="ticket-resolution-text">–†–µ—à–µ–Ω–∏–µ:</label>
                            <textarea id="ticket-resolution-text" placeholder="–û–ø–∏—à–∏—Ç–µ –∫–∞–∫ –±—ã–ª–æ —Ä–µ—à–µ–Ω–æ —ç—Ç–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∏–ª–∏ –¥–∞–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é..."></textarea>
                        </div>
                        
                        <!-- –î–µ–π—Å—Ç–≤–∏—è —Å –æ–±—Ä–∞—â–µ–Ω–∏–µ–º -->
                        <div class="ticket-actions">
                            <button id="save-ticket" class="btn btn-primary btn-glow">
                                <span class="btn-text">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ò–∑–º–µ–Ω–µ–Ω–∏—è</span>
                            </button>
                            
                            <button id="change-status" class="btn btn-success btn-glow">
                                <span class="btn-text">üîÑ –ò–∑–º–µ–Ω–∏—Ç—å –°—Ç–∞—Ç—É—Å</span>
                            </button>
                            
                            <button id="contact-user" class="btn btn-info btn-glow">
                                <span class="btn-text">üìß –°–≤—è–∑–∞—Ç—å—Å—è —Å –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º</span>
                            </button>
                            
                            <button id="close-ticket" class="btn btn-warning btn-glow">
                                <span class="btn-text">üîí –ó–∞–∫—Ä—ã—Ç—å –û–±—Ä–∞—â–µ–Ω–∏–µ</span>
                            </button>
                            
                            <button id="delete-ticket-forever" class="btn btn-danger btn-glow">
                                <span class="btn-text">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –ù–∞–≤—Å–µ–≥–¥–∞</span>
                            </button>
                        </div>
                        
                        <!-- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –∑–∞–∫—Ä—ã—Ç–∏–∏ -->
                        <div class="ticket-close-warning" id="close-warning" style="display: none;">
                            <p>üîí <strong>–ó–∞–∫—Ä—ã—Ç–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏—è</strong></p>
                            <p>–û–±—Ä–∞—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –∑–∞–∫—Ä—ã—Ç–æ, –Ω–æ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.</p>
                            <div class="close-actions">
                                <textarea id="close-resolution" placeholder="–ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)..."></textarea>
                                <button id="confirm-close" class="btn btn-warning">–ó–∞–∫—Ä—ã—Ç—å –û–±—Ä–∞—â–µ–Ω–∏–µ</button>
                                <button id="cancel-close" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </div>
                        
                        <!-- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± —É–¥–∞–ª–µ–Ω–∏–∏ -->
                        <div class="ticket-deletion-warning" id="deletion-warning" style="display: none;">
                            <p>‚ö†Ô∏è <strong>–í–ù–ò–ú–ê–ù–ò–ï!</strong> –£–¥–∞–ª–µ–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!</p>
                            <p>–í—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç <strong>–ù–ê–í–°–ï–ì–î–ê</strong> –ø–æ—Ç–µ—Ä—è–Ω—ã.</p>
                            <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ <strong>–§–ò–ó–ò–ß–ï–°–ö–ò –£–î–ê–õ–ò–¢–¨</strong> —ç—Ç–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ?</p>
                            <div class="deletion-actions">
                                <button id="confirm-delete" class="btn btn-danger">‚ö†Ô∏è –î–∞, –£–¥–∞–ª–∏—Ç—å –ù–∞–≤—Å–µ–≥–¥–∞</button>
                                <button id="cancel-delete" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="admin-footer">
            <p>üìö "–ß–∏—Ç–∞—Ç–µ–ª—å" - –ü–∞–Ω–µ–ª—å –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –û–±—Ä–∞—â–µ–Ω–∏—è–º–∏ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
            <p class="copyright">¬© 2025 –ê–Ω–Ω–∞ –ë—É—Å–µ–ª. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </footer>
    </div>
    
    <!-- Notification system -->
    <div class="notification-container" id="notification-container"></div>
    
    <!-- Scripts -->
    <script src="js/auth.js"></script>
    <script src="js/main.js"></script>
    <script src="js/tickets.js"></script>
    
    <script>
        /**
         * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏ Reader
         */
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üìö –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏—è–º–∏ "–ß–∏—Ç–∞—Ç–µ–ª—å"');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
            if (typeof checkAuthStatus === 'function') {
                checkAuthStatus();
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–±—Ä–∞—â–µ–Ω–∏–π
            if (typeof initTicketsPage === 'function') {
                initTicketsPage();
            } else {
                console.log('üìö –§—É–Ω–∫—Ü–∏—è initTicketsPage –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é');
                initBasicTickets();
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–Ω–∏–∂–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é
            if (typeof initReaderMatrix === 'function') {
                initReaderMatrix(true); // subtle mode –¥–ª—è —Ä–∞–±–æ—á–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
            }
        });
        
        /**
         * –ë–∞–∑–æ–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞—â–µ–Ω–∏–π
         */
        function initBasicTickets() {
            console.log('üìö –ë–∞–∑–æ–≤–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞—â–µ–Ω–∏–π');
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
            loadTicketsData();
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
            setupTicketFilters();
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
            setupTicketButtons();
        }
        
        /**
         * –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π
         */
        function loadTicketsData() {
            const tbody = document.querySelector('#tickets-table tbody');
            const emptyState = document.getElementById('empty-state');
            const table = document.getElementById('tickets-table');
            
            if (!tbody) return;
            
            // –ò–º–∏—Ç–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö
            setTimeout(() => {
                const hasData = localStorage.getItem('reader-tickets-demo') === 'true';
                
                if (!hasData) {
                    showEmptyState();
                } else {
                    loadTicketsDemo();
                }
            }, 1000);
        }
        
        /**
         * –ü–æ–∫–∞–∑ –ø—É—Å—Ç–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
         */
        function showEmptyState() {
            const tbody = document.querySelector('#tickets-table tbody');
            const emptyState = document.getElementById('empty-state');
            const table = document.getElementById('tickets-table');
            
            tbody.innerHTML = '';
            table.style.display = 'none';
            emptyState.style.display = 'block';
            
            document.getElementById('pagination-range').textContent = '0-0';
            document.getElementById('pagination-total').textContent = '0';
        }
        
        /**
         * –ó–∞–≥—Ä—É–∑–∫–∞ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π
         */
        function loadTicketsDemo() {
            const tbody = document.querySelector('#tickets-table tbody');
            const emptyState = document.getElementById('empty-state');
            const table = document.getElementById('tickets-table');
            
            if (!tbody) return;
            
            const demoData = [
                {
                    id: 'RDER-001',
                    subject: '–ü–æ–º–æ–≥–∏—Ç–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å –º–æ—Ç–∏–≤–∞—Ü–∏–µ–π –∫ —á—Ç–µ–Ω–∏—é',
                    status: 'open',
                    priority: 'medium',
                    user: '–ú–∞—Ä–∏—è –ö. (@maria_k)',
                    created: '2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥',
                    updated: '2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥'
                },
                {
                    id: 'RDER-002',
                    subject: '–õ–∏—á–Ω–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ø–æ –≤—ã–±–æ—Ä—É –∫–Ω–∏–≥',
                    status: 'in_progress',
                    priority: 'high',
                    user: '–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ü. (@alex_p)',
                    created: '1 –¥–µ–Ω—å –Ω–∞–∑–∞–¥',
                    updated: '3 —á–∞—Å–∞ –Ω–∞–∑–∞–¥'
                },
                {
                    id: 'RDER-003',
                    subject: '–°–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å —Å–∞–º–æ–ø—Ä–∏–Ω—è—Ç–∏–µ–º –ø–æ—Å–ª–µ –ø—Ä–æ—á—Ç–µ–Ω–∏—è —Ü–∏—Ç–∞—Ç',
                    status: 'open',
                    priority: 'high',
                    user: '–ï–ª–µ–Ω–∞ –°. (@elena_s)',
                    created: '2 –¥–Ω—è –Ω–∞–∑–∞–¥',
                    updated: '6 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥'
                },
                {
                    id: 'RDER-004',
                    subject: '–ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤',
                    status: 'resolved',
                    priority: 'low',
                    user: '–î–º–∏—Ç—Ä–∏–π –õ. (@dmitry_l)',
                    created: '3 –¥–Ω—è –Ω–∞–∑–∞–¥',
                    updated: '1 –¥–µ–Ω—å –Ω–∞–∑–∞–¥'
                },
                {
                    id: 'RDER-005',
                    subject: '–ó–∞–ø—Ä–æ—Å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ —Å–æ–±–æ–π',
                    status: 'closed',
                    priority: 'medium',
                    user: '–ê–Ω–Ω–∞ –í. (@anna_v)',
                    created: '1 –Ω–µ–¥–µ–ª—è –Ω–∞–∑–∞–¥',
                    updated: '5 –¥–Ω–µ–π –Ω–∞–∑–∞–¥'
                }
            ];
            
            emptyState.style.display = 'none';
            table.style.display = 'table';
            
            tbody.innerHTML = demoData.map(item => {
                const statusMap = {
                    'open': { class: 'status-open', text: '–û—Ç–∫—Ä—ã—Ç' },
                    'in_progress': { class: 'status-progress', text: '–í —Ä–∞–±–æ—Ç–µ' },
                    'resolved': { class: 'status-resolved', text: '–†–µ—à–µ–Ω' },
                    'closed': { class: 'status-closed', text: '–ó–∞–∫—Ä—ã—Ç' }
                };
                
                const priorityMap = {
                    'low': { class: 'priority-low', text: '–ù–∏–∑–∫–∏–π' },
                    'medium': { class: 'priority-medium', text: '–°—Ä–µ–¥–Ω–∏–π' },
                    'high': { class: 'priority-high', text: '–í—ã—Å–æ–∫–∏–π' },
                    'urgent': { class: 'priority-urgent', text: '–°—Ä–æ—á–Ω—ã–π' }
                };
                
                return `
                    <tr>
                        <td><strong>${item.id}</strong></td>
                        <td class="subject-cell">${item.subject}</td>
                        <td><span class="status-badge ${statusMap[item.status].class}">${statusMap[item.status].text}</span></td>
                        <td><span class="priority-badge ${priorityMap[item.priority].class}">${priorityMap[item.priority].text}</span></td>
                        <td>${item.user}</td>
                        <td>${item.created}</td>
                        <td>${item.updated}</td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="viewTicket('${item.id}')" title="–ü—Ä–æ—Å–º–æ—Ç—Ä">üëÅÔ∏è</button>
                            <button class="btn btn-sm btn-success" onclick="editTicket('${item.id}')" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</button>
                        </td>
                    </tr>
                `;
            }).join('');
            
            document.getElementById('pagination-range').textContent = `1-${demoData.length}`;
            document.getElementById('pagination-total').textContent = demoData.length;
        }
        
        /**
         * –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤
         */
        function setupTicketFilters() {
            const statusFilter = document.getElementById('status-filter');
            const priorityFilter = document.getElementById('priority-filter');
            const searchInput = document.getElementById('search-tickets');
            
            if (statusFilter) statusFilter.addEventListener('change', filterTickets);
            if (priorityFilter) priorityFilter.addEventListener('change', filterTickets);
            if (searchInput) searchInput.addEventListener('input', debounce(filterTickets, 300));
        }
        
        /**
         * –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–Ω–æ–ø–æ–∫
         */
        function setupTicketButtons() {
            const refreshBtn = document.getElementById('refresh-tickets');
            
            if (refreshBtn) refreshBtn.addEventListener('click', () => {
                showNotification('info', '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ–±—Ä–∞—â–µ–Ω–∏–π...');
                setTimeout(() => {
                    loadTicketsData();
                    showNotification('success', '–°–ø–∏—Å–æ–∫ –æ–±–Ω–æ–≤–ª–µ–Ω');
                }, 1000);
            });
        }
        
        /**
         * –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞—â–µ–Ω–∏–π
         */
        function filterTickets() {
            showNotification('info', '–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤...');
            setTimeout(() => {
                showNotification('success', '–§–∏–ª—å—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã');
            }, 500);
        }
        
        /**
         * –ü—Ä–æ—Å–º–æ—Ç—Ä –æ–±—Ä–∞—â–µ–Ω–∏—è
         */
        function viewTicket(ticketId) {
            const overlay = document.getElementById('ticket-detail-overlay');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–µ—Ç–∞–ª–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è (–¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ)
            document.getElementById('detail-ticket-id').textContent = ticketId;
            document.getElementById('detail-ticket-subject').textContent = '–ü–æ–º–æ–≥–∏—Ç–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å –º–æ—Ç–∏–≤–∞—Ü–∏–µ–π –∫ —á—Ç–µ–Ω–∏—é';
            document.getElementById('detail-ticket-user-name').textContent = '–ú–∞—Ä–∏—è –ö.';
            document.getElementById('detail-ticket-username').textContent = '@maria_k';
            document.getElementById('detail-ticket-email').textContent = 'maria.k@example.com';
            document.getElementById('detail-ticket-created').textContent = '04.07.2025 12:30';
            document.getElementById('detail-ticket-updated').textContent = '04.07.2025 12:30';
            
            // –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            document.getElementById('detail-ticket-message').innerHTML = `
                <div class="user-message">
                    <p>–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –ê–Ω–Ω–∞! –£ –º–µ–Ω—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –º–æ—Ç–∏–≤–∞—Ü–∏–µ–π –∫ —á—Ç–µ–Ω–∏—é. –†–∞–Ω—å—à–µ —è —á–∏—Ç–∞–ª–∞ –º–Ω–æ–≥–æ, –Ω–æ —Å–µ–π—á–∞—Å –Ω–µ –º–æ–≥—É –∑–∞—Å—Ç–∞–≤–∏—Ç—å —Å–µ–±—è –æ—Ç–∫—Ä—ã—Ç—å –∫–Ω–∏–≥—É.</p>
                    <p>–í–∞—à–∏ —Ü–∏—Ç–∞—Ç—ã –≤ –±–æ—Ç–µ –æ—á–µ–Ω—å –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—Ç, –Ω–æ —Ö–æ—á–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Å–æ–≤–µ—Ç –∏–º–µ–Ω–Ω–æ –¥–ª—è –º–æ–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏. –ú–æ–∂–µ—Ç–µ –ø–æ–º–æ—á—å?</p>
                </div>
            `;
            
            // –ò—Å—Ç–æ—Ä–∏—è –¥–∏–∞–ª–æ–≥–∞ —Å –±–æ—Ç–æ–º
            setTimeout(() => {
                document.getElementById('detail-ticket-conversation').innerHTML = `
                    <div class="conversation-history">
                        <div class="message message-user">
                            <span class="message-time">12:25</span>
                            <div class="message-content">–ü–æ–º–æ–≥–∏—Ç–µ –º–Ω–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å –º–æ—Ç–∏–≤–∞—Ü–∏–µ–π –∫ —á—Ç–µ–Ω–∏—é</div>
                        </div>
                        <div class="message message-bot">
                            <span class="message-time">12:26</span>
                            <div class="message-content">–≠—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è –ê–Ω–Ω—ã. –Ø –ø–µ—Ä–µ–¥–∞–ª–∞ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∏ –æ–Ω–∞ —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.</div>
                        </div>
                    </div>
                `;
            }, 500);
            
            overlay.style.display = 'flex';
            showNotification('info', `–ó–∞–≥—Ä—É–∑–∫–∞ –¥–µ—Ç–∞–ª–µ–π –æ–±—Ä–∞—â–µ–Ω–∏—è ${ticketId}`);
        }
        
        /**
         * –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏—è
         */
        function editTicket(ticketId) {
            viewTicket(ticketId);
            // –ü–µ—Ä–µ–≤–æ–¥–∏–º –≤ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            document.getElementById('detail-ticket-status').value = 'in_progress';
            showNotification('info', `–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏—è ${ticketId}`);
        }
        
        /**
         * –£—Ç–∏–ª–∏—Ç—ã
         */
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        function showNotification(type, message) {
            const container = document.getElementById('notification-container');
            if (!container) {
                alert(message);
                return;
            }
            
            const iconMap = {
                'success': '‚úÖ',
                'error': '‚ùå',
                'warning': '‚ö†Ô∏è',
                'info': 'üìö'
            };
            
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <span class="notification-icon">${iconMap[type] || 'üìö'}</span>
                    <span class="notification-message">${message}</span>
                </div>
                <button class="notification-close" onclick="this.parentElement.remove()">√ó</button>
            `;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 5000);
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        document.addEventListener('click', (e) => {
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –¥–µ—Ç–∞–ª–µ–π –æ–±—Ä–∞—â–µ–Ω–∏—è
            if (e.target.id === 'close-ticket-detail' || e.target.closest('#close-ticket-detail')) {
                document.getElementById('ticket-detail-overlay').style.display = 'none';
            }
            
            // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ ID –æ–±—Ä–∞—â–µ–Ω–∏—è
            if (e.target.id === 'copy-ticket-id') {
                const ticketId = document.getElementById('detail-ticket-id').textContent;
                navigator.clipboard.writeText(ticketId).then(() => {
                    showNotification('success', 'ID –æ–±—Ä–∞—â–µ–Ω–∏—è —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω');
                });
            }
            
            // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ email
            if (e.target.id === 'copy-user-email') {
                const email = document.getElementById('detail-ticket-email').textContent;
                navigator.clipboard.writeText(email).then(() => {
                    showNotification('success', 'Email —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω');
                });
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
            if (e.target.id === 'save-ticket') {
                showNotification('info', '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π...');
                setTimeout(() => {
                    showNotification('success', '–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
                }, 1000);
            }
            
            // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
            if (e.target.id === 'change-status') {
                const newStatus = document.getElementById('detail-ticket-status').value;
                showNotification('success', `–°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ "${newStatus}"`);
            }
            
            // –°–≤—è–∑–∞—Ç—å—Å—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
            if (e.target.id === 'contact-user') {
                const email = document.getElementById('detail-ticket-email').textContent;
                const subject = 'Re: ' + document.getElementById('detail-ticket-subject').textContent;
                const mailtoLink = `mailto:${email}?subject=${encodeURIComponent(subject)}`;
                window.open(mailtoLink);
                showNotification('info', '–û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ—á—Ç–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞...');
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏—è
            if (e.target.id === 'close-ticket') {
                document.getElementById('close-warning').style.display = 'block';
            }
            
            if (e.target.id === 'confirm-close') {
                showNotification('success', '–û–±—Ä–∞—â–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ');
                document.getElementById('close-warning').style.display = 'none';
                document.getElementById('ticket-detail-overlay').style.display = 'none';
                loadTicketsData();
            }
            
            if (e.target.id === 'cancel-close') {
                document.getElementById('close-warning').style.display = 'none';
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏—è
            if (e.target.id === 'delete-ticket-forever') {
                document.getElementById('deletion-warning').style.display = 'block';
            }
            
            if (e.target.id === 'confirm-delete') {
                showNotification('success', '–û–±—Ä–∞—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ –Ω–∞–≤—Å–µ–≥–¥–∞');
                document.getElementById('deletion-warning').style.display = 'none';
                document.getElementById('ticket-detail-overlay').style.display = 'none';
                loadTicketsData();
            }
            
            if (e.target.id === 'cancel-delete') {
                document.getElementById('deletion-warning').style.display = 'none';
            }
        });
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–º–æ-–æ–±—Ä–∞—â–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
        if (!localStorage.getItem('reader-tickets-demo')) {
            setTimeout(() => {
                if (confirm('–°–æ–∑–¥–∞—Ç—å –¥–µ–º–æ-–æ–±—Ä–∞—â–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è?')) {
                    localStorage.setItem('reader-tickets-demo', 'true');
                    loadTicketsData();
                    showNotification('success', '–î–µ–º–æ-–æ–±—Ä–∞—â–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ');
                }
            }, 2000);
        }
    </script>
</body>
</html>