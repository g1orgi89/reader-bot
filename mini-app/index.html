<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#D2452C">
    
    <!-- PWA Meta -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="–ß–∏—Ç–∞—Ç–µ–ª—å">
    
    <title>–ß–∏—Ç–∞—Ç–µ–ª—å - –î–Ω–µ–≤–Ω–∏–∫ —Ü–∏—Ç–∞—Ç –æ—Ç –ê–Ω–Ω—ã –ë—É—Å–µ–ª</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- CSS Styles -->
    <link rel="stylesheet" href="./css/variables.css">
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/base.css">
    <link rel="stylesheet" href="./css/mobile.css">
    
    <!-- Component Styles -->
    <link rel="stylesheet" href="./css/components/buttons.css">
    <link rel="stylesheet" href="./css/components/cards.css">
    <link rel="stylesheet" href="./css/components/forms.css">
    <link rel="stylesheet" href="./css/components/modals.css">
    <link rel="stylesheet" href="./css/components/navigation.css">
    
    <!-- Page Styles -->
    <link rel="stylesheet" href="./css/pages/home.css">
    <link rel="stylesheet" href="./css/pages/diary.css">
    <link rel="stylesheet" href="./css/pages/reports.css">
    <link rel="stylesheet" href="./css/pages/catalog.css">
    <link rel="stylesheet" href="./css/pages/community.css">
    
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-spinner"></div>
        <p>–ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∞—à –¥–Ω–µ–≤–Ω–∏–∫ —Ü–∏—Ç–∞—Ç...</p>
    </div>

    <!-- Main App Container -->
    <main id="app" class="app-container" style="display: none;">
        <!-- Home Header with User Profile (Only for Home Page) -->
        <header id="home-header" class="home-header" style="display: none;">
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">üë§</div>
                <div class="user-details">
                    <h3 id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h3>
                    <p>–ß–∏—Ç–∞—Ç–µ–ª—å</p>
                </div>
            </div>
            <button class="menu-button" id="menu-trigger">‚ãØ</button>
        </header>

        <!-- Regular Page Header (For Other Pages) -->
        <header id="page-header" class="page-header" style="display: none;">
            <h1 id="page-title">–ß–∏—Ç–∞—Ç–µ–ª—å</h1>
        </header>

        <!-- Page Content Area -->
        <section id="page-content" class="page-content">
            <!-- Pages will be dynamically loaded here -->
        </section>

        <!-- Bottom Navigation -->
        <nav id="bottom-nav" class="bottom-nav">
            <button class="nav-item active" data-page="home">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                </svg>
                <span class="nav-label">–ì–ª–∞–≤–Ω–∞—è</span>
            </button>
            
            <button class="nav-item" data-page="diary">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                </svg>
                <span class="nav-label">–î–Ω–µ–≤–Ω–∏–∫</span>
            </button>
            
            <button class="nav-item" data-page="reports">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/>
                </svg>
                <span class="nav-label">–û—Ç—á–µ—Ç—ã</span>
            </button>
            
            <button class="nav-item" data-page="catalog">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
                </svg>
                <span class="nav-label">–ö–∞—Ç–∞–ª–æ–≥</span>
            </button>
            
            <button class="nav-item" data-page="community">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                    <circle cx="12" cy="7" r="4"/>
                </svg>
                <span class="nav-label">–°–æ–æ–±—â–µ—Å—Ç–≤–æ</span>
            </button>
        </nav>
    </main>

    <!-- Modal Container -->
    <div id="modal-container" class="modal-container"></div>

    <!-- Configuration -->
    <script src="./config/api-endpoints.js"></script>
    <script src="./config/app-config.js"></script>

    <!-- Core JavaScript -->
    <script src="./js/core/State.js"></script>
    <script src="./js/core/Router.js"></script>
    <script src="./js/core/App.js"></script>

    <!-- Services -->
    <script src="./js/services/telegram.js"></script>
    <script src="./js/services/storage.js"></script>
    <script src="./js/services/api.js"></script>
    <script src="./js/services/ios-fix.js"></script>

    <!-- Utilities -->
    <script src="./js/utils/helpers.js"></script>
    <script src="./js/utils/constants.js"></script>
    <script src="./js/utils/validators.js"></script>
    <script src="./js/utils/menuHandlers.js"></script>

    <!-- Components -->
    <script src="./js/components/ui/Button.js"></script>
    <script src="./js/components/ui/Card.js"></script>
    <script src="./js/components/ui/Modal.js"></script>
    <script src="./js/components/ui/Form.js"></script>

    <!-- Navigation Components -->
    <script src="./js/components/navigation/BottomNav.js"></script>
    <script src="./js/components/navigation/TopMenu.js"></script>

    <!-- Modal Components -->
    <script src="./js/components/modals/ProfileModal.js"></script>
    <script src="./js/components/modals/AchievementsModal.js"></script>
    <script src="./js/components/modals/SettingsModal.js"></script>

    <!-- Quote Components -->
    <script src="./js/components/quote/QuoteCard.js"></script>
    <script src="./js/components/quote/QuoteForm.js"></script>

    <!-- Pages -->
    <script src="./js/pages/HomePage.js"></script>
    <script src="./js/pages/DiaryPage.js"></script>
    <script src="./js/pages/ReportsPage.js"></script>
    <script src="./js/pages/CatalogPage.js"></script>
    <script src="./js/pages/CommunityPage.js"></script>
    <script src="./js/pages/OnboardingPage.js"></script>

    <!-- App Initialization -->
    <script>
        // Initialize app when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize Telegram Web App
            if (window.Telegram?.WebApp) {
                window.Telegram.WebApp.ready();
                window.Telegram.WebApp.expand();
            }
            
            // Start the application
            const app = new ReaderApp();
            app.init();
        });

        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>