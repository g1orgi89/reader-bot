<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Reader Bot</title>
    
    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- üé® CSS —Å—Ç–∏–ª–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ (–ò–°–ü–†–ê–í–õ–ï–ù–û) -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/base.css">
    
    <!-- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã CSS -->
    <link rel="stylesheet" href="css/components/navigation.css">
    <link rel="stylesheet" href="css/components/buttons.css">
    <link rel="stylesheet" href="css/components/cards.css">
    <link rel="stylesheet" href="css/components/forms.css">
    <link rel="stylesheet" href="css/components/modals.css">
    
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü—ã CSS -->
    <link rel="stylesheet" href="css/pages/home.css">
    <link rel="stylesheet" href="css/pages/onboarding.css">
    <link rel="stylesheet" href="css/pages/diary.css">
    <link rel="stylesheet" href="css/pages/reports.css">
    <link rel="stylesheet" href="css/pages/catalog.css">
    <link rel="stylesheet" href="css/pages/community.css">
    
    <!-- –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è -->
    <link rel="stylesheet" href="css/mobile.css">
    
    <!-- üîß –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: iOS Navigation Fix (–ó–ê–ì–†–£–ñ–ê–ï–¢–°–Ø –ü–û–°–õ–ï–î–ù–ò–ú!) -->
    <link rel="stylesheet" href="css/ios-navigation-fix.css">
</head>
<body>
    <!-- üì± –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">üìö</div>
            <div class="loading-text">Reader Bot</div>
            <div class="loading-subtitle">–ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∞—à –¥–Ω–µ–≤–Ω–∏–∫ –º—É–¥—Ä–æ—Å—Ç–∏...</div>
            <div class="loading-spinner"></div>
        </div>
    </div>

    <!-- üè† –ì–õ–ê–í–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï -->
    <div id="app" class="app-container" style="display: none;">
        
        <!-- üìÑ –ö–û–ù–¢–ï–ô–ù–ï–† –î–õ–Ø –°–û–î–ï–†–ñ–ò–ú–û–ì–û –°–¢–†–ê–ù–ò–¶ (–ë–ï–ó –•–ï–î–ï–†–û–í!) -->
        <div id="page-content" class="page-content">
            <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
        </div>

        <!-- üì± –ù–ò–ñ–ù–Ø–Ø –ù–ê–í–ò–ì–ê–¶–ò–Ø -->
        <nav id="bottom-nav" class="bottom-nav">
            <div class="nav-item active" data-page="home">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                </svg>
                <span class="nav-label">–ì–ª–∞–≤–Ω–∞—è</span>
            </div>
            
            <div class="nav-item" data-page="diary">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                </svg>
                <span class="nav-label">–î–Ω–µ–≤–Ω–∏–∫</span>
            </div>
            
            <div class="nav-item" data-page="reports">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"/>
                </svg>
                <span class="nav-label">–û—Ç—á–µ—Ç—ã</span>
            </div>
            
            <div class="nav-item" data-page="catalog">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
                </svg>
                <span class="nav-label">–ö–∞—Ç–∞–ª–æ–≥</span>
            </div>
            
            <div class="nav-item" data-page="community">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                    <circle cx="12" cy="7" r="4"/>
                </svg>
                <span class="nav-label">–°–æ–æ–±—â–µ—Å—Ç–≤–æ</span>
            </div>
        </nav>

        <!-- üéØ –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê -->
        
        <!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
        <div id="menu-modal" class="menu-modal" style="display: none;">
            <div class="menu-backdrop"></div>
            <div class="menu-content">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –º–µ–Ω—é –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ TopMenu.js -->
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Ñ–∏–ª—è -->
        <div id="profile-modal" class="modal" style="display: none;">
            <div class="modal-backdrop"></div>
            <div class="modal-content">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–æ—Ñ–∏–ª—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ–∑–∂–µ -->
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
        <div id="settings-modal" class="modal" style="display: none;">
            <div class="modal-backdrop"></div>
            <div class="modal-content">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ–∑–∂–µ -->
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π -->
        <div id="achievements-modal" class="modal" style="display: none;">
            <div class="modal-backdrop"></div>
            <div class="modal-content">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ–∑–∂–µ -->
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–º–æ—â–∏ -->
        <div id="help-modal" class="modal" style="display: none;">
            <div class="modal-backdrop"></div>
            <div class="modal-content">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –ø–æ–º–æ—â–∏ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ–∑–∂–µ -->
            </div>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏" -->
        <div id="about-modal" class="modal" style="display: none;">
            <div class="modal-backdrop"></div>
            <div class="modal-content">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç "–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏" –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –ø–æ–∑–∂–µ -->
            </div>
        </div>
    </div>

    <!-- üìö JavaScript —Ñ–∞–π–ª—ã (–ò–°–ü–†–ê–í–õ–ï–ù–´ –ü–£–¢–ò!) -->
    
    <!-- üîç –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ï: Comprehensive Debug System (–ó–ê–ì–†–£–ñ–ê–ï–¢–°–Ø –ü–ï–†–í–´–ú!) -->
    <script src="js/utils/comprehensive-debug-system-fixed.js"></script>
    

    
    <!-- üîß –ù–û–í–û–ï: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä viewport –≤—ã—Å–æ—Ç—ã -->
    <script src="js/utils/viewport-calculator.js"></script>
    
    <!-- üñºÔ∏è –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ -->
    <script src="js/utils/imageUtils.js"></script>
    
    <!-- üß™ –¢–µ—Å—Ç—ã –¥–ª—è –∞–≤–∞—Ç–∞—Ä upload (—Ç–æ–ª—å–∫–æ –≤ dev) -->
    <script src="js/utils/avatarUploadTest.js"></script>
    
    <!-- –Ø–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <script src="js/core/State.js"></script>
    <script src="js/core/Router.js"></script>
    <script src="js/core/App.js"></script>
    
    <!-- üçé –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: iOS —Ñ–∏–∫—Å—ã –ü–ï–†–ï–î telegram.js -->
    <script src="js/services/ios-fix.js"></script>
    
    <!-- –°–µ—Ä–≤–∏—Å—ã (–ò–°–ü–†–ê–í–õ–ï–ù–´ –ò–ú–ï–ù–ê –§–ê–ô–õ–û–í) -->
    <script src="js/services/telegram.js"></script>
    <script src="js/services/api.js"></script>
    
    <!-- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–ò–°–ü–†–ê–í–õ–ï–ù–´ –ü–£–¢–ò) -->
    <script src="js/components/navigation/BottomNav.js"></script>
    <script src="js/components/navigation/TopMenu.js"></script>
    
    <!-- UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã -->
    <script src="js/components/ui/Modal.js"></script>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <script src="js/components/modals/ProfileModal.js"></script>
    
    <!-- –°—Ç—Ä–∞–Ω–∏—Ü—ã -->
    <script src="js/pages/HomePage.js"></script>
    <script src="js/pages/DiaryPage.js"></script>
    <script src="js/pages/ReportsPage.js"></script>
    <script src="js/pages/CatalogPage.js"></script>
    <script src="js/pages/CommunityPage.js"></script>
    <script src="js/pages/OnboardingPage.js"></script>
    
    <!-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è -->
    <script>
        // üîß –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ù–ï–ú–ï–î–õ–ï–ù–ù–ê–Ø iOS –°–¢–ê–ë–ò–õ–ò–ó–ê–¶–ò–Ø
        console.log('üçé –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è iOS —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è...');
        
        // –ï–î–ò–ù–°–¢–í–ï–ù–ù–û–ï –æ–±—ä—è–≤–ª–µ–Ω–∏–µ isIOS –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏
        window.isIOSDevice = /iPad|iPhone|iPod/.test(navigator.userAgent) || 
                            (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
        
        // üîç –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ô Debug System –ù–ï–ú–ï–î–õ–ï–ù–ù–û –¥–ª—è iOS
        let debugSessionId = null;
        
        if (window.isIOSDevice) {
            console.log('üçé iOS —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ - –ø—Ä–∏–º–µ–Ω—è–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∏–∫—Å—ã...');
            
            // –î–æ–±–∞–≤–ª—è–µ–º iOS –∫–ª–∞—Å—Å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
            document.documentElement.classList.add('ios-device');
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
            document.documentElement.style.cssText += `
                height: calc(100vh + 1px) !important;
                overflow-y: auto !important;
                -webkit-overflow-scrolling: touch !important;
                overscroll-behavior: none !important;
                -webkit-overscroll-behavior: none !important;
            `;
            
            document.body.style.cssText += `
                min-height: calc(100vh + 1px) !important;
                overscroll-behavior: none !important;
                -webkit-overscroll-behavior: none !important;
                -webkit-overflow-scrolling: touch !important;
            `;
            
            console.log('‚úÖ –ë–∞–∑–æ–≤—ã–µ iOS —Ñ–∏–∫—Å—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ');
            
            // üîç –ò–°–ü–†–ê–í–õ–ï–ù–û: –ó–∞–ø—É—Å–∫ –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ô debug —Å–∏—Å—Ç–µ–º—ã –¥–ª—è iOS
            if (window.ComprehensiveDebugSystemFixed) {
                console.log('üîç –ó–∞–ø—É—Å–∫ –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ô debug —Å–∏—Å—Ç–µ–º—ã –¥–ª—è iOS...');
                window.debugSystemFixed = new ComprehensiveDebugSystemFixed();
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π userId, –ø–æ–∑–∂–µ –æ–±–Ω–æ–≤–∏–º –∏–∑ Telegram
                const tempUserId = 'ios_debug_' + Date.now();
                window.debugSystemFixed.startSession(tempUserId).then(sessionId => {
                    debugSessionId = sessionId;
                    console.log('‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø Debug —Å–∏—Å—Ç–µ–º–∞ –∑–∞–ø—É—â–µ–Ω–∞:', sessionId);
                }).catch(error => {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ô debug —Å–∏—Å—Ç–µ–º—ã:', error);
                });
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É Telegram Web App
        if (typeof window.Telegram !== 'undefined' && window.Telegram.WebApp) {
            console.log('üöÄ Telegram Web App –æ–±–Ω–∞—Ä—É–∂–µ–Ω');
            
            // üîç –ò–°–ü–†–ê–í–õ–ï–ù–û: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Telegram API —Å–æ–±—ã—Ç–∏—è
            if (window.debugSystemFixed && window.isIOSDevice) {
                window.debugSystemFixed.log('TELEGRAM', 'INFO', 'Telegram WebApp detected', {
                    version: window.Telegram.WebApp.version,
                    platform: window.Telegram.WebApp.platform,
                    isExpanded: window.Telegram.WebApp.isExpanded
                });
            }
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Telegram Web App
            window.Telegram.WebApp.ready();
            window.Telegram.WebApp.expand();
            
            // üîç –ò–°–ü–†–ê–í–õ–ï–ù–û: –û–±–Ω–æ–≤–ª—è–µ–º userId –∏–∑ Telegram –¥–∞–Ω–Ω—ã—Ö
            if (window.debugSystemFixed && window.isIOSDevice && debugSessionId) {
                const telegramUser = window.Telegram.WebApp.initDataUnsafe?.user;
                if (telegramUser) {
                    // –ó–∞–≤–µ—Ä—à–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—É—é —Å–µ—Å—Å–∏—é –∏ –Ω–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—É—é —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º userId
                    window.debugSystemFixed.endSession().then(() => {
                        return window.debugSystemFixed.startSession(telegramUser.id.toString());
                    }).then(newSessionId => {
                        debugSessionId = newSessionId;
                        console.log('‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø Debug —Å–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–∞ —Å Telegram userId:', newSessionId);
                    }).catch(error => {
                        console.error('‚ùå –û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ô debug —Å–∏—Å—Ç–µ–º—ã:', error);
                    });
                }
            }
            
            if (window.isIOSDevice) {
                console.log('üçé –ü—Ä–∏–º–µ–Ω—è–µ–º Telegram iOS —Ñ–∏–∫—Å—ã...');
                
                // üîç –ò–°–ü–†–ê–í–õ–ï–ù–û: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Telegram iOS —Ñ–∏–∫—Å–æ–≤
                if (window.debugSystemFixed) {
                    window.debugSystemFixed.log('TELEGRAM', 'INFO', 'Applying Telegram iOS fixes');
                }
                
                // Bot API 7.7+ - –û—Ç–∫–ª—é—á–∞–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å–≤–∞–π–ø—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è "–≤—Å–ø–ª—ã–≤–∞–Ω–∏—è" –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                if (window.Telegram.WebApp.disableVerticalSwipes) {
                    window.Telegram.WebApp.disableVerticalSwipes();
                    console.log('üîß iOS Fix: –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å–≤–∞–π–ø—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã');
                    
                    if (window.debugSystemFixed) {
                        window.debugSystemFixed.log('TELEGRAM', 'INFO', 'Vertical swipes disabled for iOS');
                    }
                }
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º Safe Area —Å –Ω–æ–≤—ã–º API Telegram
                if (window.Telegram.WebApp.safeAreaInset) {
                    const safeArea = window.Telegram.WebApp.safeAreaInset;
                    document.documentElement.style.setProperty('--tg-safe-area-top', `${safeArea.top}px`);
                    document.documentElement.style.setProperty('--tg-safe-area-bottom', `${safeArea.bottom}px`);
                    document.documentElement.style.setProperty('--tg-safe-area-left', `${safeArea.left}px`);
                    document.documentElement.style.setProperty('--tg-safe-area-right', `${safeArea.right}px`);
                    console.log('üîß iOS Fix: Safe Area —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞', safeArea);
                    
                    if (window.debugSystemFixed) {
                        window.debugSystemFixed.log('TELEGRAM', 'INFO', 'Safe Area configured', { safeArea });
                    }
                }
                
                // –§–∏–∫—Å–∏—Ä—É–µ–º viewport height –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
                const updateViewportHeight = () => {
                    const vh = window.innerHeight * 0.01;
                    document.documentElement.style.setProperty('--vh', `${vh}px`);
                    
                    if (window.debugSystemFixed) {
                        window.debugSystemFixed.log('VIEWPORT', 'DEBUG', 'Viewport height updated', {
                            innerHeight: window.innerHeight,
                            vh: vh
                        });
                    }
                };
                
                updateViewportHeight();
                window.addEventListener('resize', updateViewportHeight);
                window.addEventListener('orientationchange', () => {
                    setTimeout(updateViewportHeight, 300);
                });
                
                console.log('‚úÖ Telegram iOS —Ñ–∏–∫—Å—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã');
            }
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ü–≤–µ—Ç–∞ —Ç–µ–º—ã Telegram
            const themeParams = window.Telegram.WebApp.themeParams;
            if (themeParams.bg_color) {
                document.documentElement.style.setProperty('--tg-bg-color', themeParams.bg_color);
            }
            if (themeParams.text_color) {
                document.documentElement.style.setProperty('--tg-text-color', themeParams.text_color);
            }
        } else {
            console.log('üß™ –ó–∞–ø—É—Å–∫ –≤ debug —Ä–µ–∂–∏–º–µ (–Ω–µ –≤ Telegram)');
            
            // üîç –ò–°–ü–†–ê–í–õ–ï–ù–û: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è debug —Ä–µ–∂–∏–º–∞
            if (window.debugSystemFixed && window.isIOSDevice) {
                window.debugSystemFixed.log('INIT', 'WARNING', 'Running in debug mode (not in Telegram)');
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                console.log('üîÑ –ù–∞—á–∞–ª–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Reader Bot');
                
                // üîç –ò–°–ü–†–ê–í–õ–ï–ù–û: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                if (window.debugSystemFixed && window.isIOSDevice) {
                    window.debugSystemFixed.log('INIT', 'INFO', 'Starting Reader Bot initialization');
                }
                
                // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                const app = new ReaderApp();
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
                await app.init();
                
                console.log('‚úÖ Reader Bot —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                
                // üîç –ò–°–ü–†–ê–í–õ–ï–ù–û: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
                if (window.debugSystemFixed && window.isIOSDevice) {
                    window.debugSystemFixed.log('INIT', 'INFO', 'Reader Bot initialization completed successfully');
                }
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:', error);
                
                // üîç –ò–°–ü–†–ê–í–õ–ï–ù–û: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–∏
                if (window.debugSystemFixed && window.isIOSDevice) {
                    window.debugSystemFixed.log('ERROR', 'CRITICAL', 'Reader Bot initialization failed', {
                        error: error.message,
                        stack: error.stack
                    });
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
                const loadingScreen = document.getElementById('loading-screen');
                if (loadingScreen) {
                    loadingScreen.innerHTML = `
                        <div class="loading-content">
                            <div class="loading-logo">‚ö†Ô∏è</div>
                            <div class="loading-text">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>
                            <div class="loading-subtitle">${error.message}</div>
                            <button onclick="location.reload()" class="retry-btn">
                                üîÑ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
                            </button>
                        </div>
                    `;
                }
            }
        });
        
        // üîß iOS –°–ü–ï–¶–ò–§–ò–ß–ù–´–ï –§–ò–ö–°–´: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ bounce –∏ –∑—É–º–∞
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
                
                // üîç –ò–°–ü–†–ê–í–õ–ï–ù–û: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ multi-touch —Å–æ–±—ã—Ç–∏–π
                if (window.debugSystemFixed && window.isIOSDevice) {
                    window.debugSystemFixed.log('TOUCH', 'WARNING', 'Multi-touch prevented', {
                        touchCount: e.touches.length
                    });
                }
            }
        }, { passive: false });
        
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –∑—É–º –ø—Ä–∏ –¥–≤–æ–π–Ω–æ–º —Ç–∞–ø–µ
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(e) {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
                
                // üîç –ò–°–ü–†–ê–í–õ–ï–ù–û: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥–≤–æ–π–Ω–æ–≥–æ —Ç–∞–ø–∞
                if (window.debugSystemFixed && window.isIOSDevice) {
                    window.debugSystemFixed.log('TOUCH', 'INFO', 'Double tap zoom prevented', {
                        timeSinceLastTouch: now - lastTouchEnd
                    });
                }
            }
            lastTouchEnd = now;
        }, false);
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –æ—Ç–ª–∞–¥–∫–∏
        window.getDebugStats = () => {
            if (window.debugSystemFixed) {
                return window.debugSystemFixed.getLocalStats();
            }
            return null;
        };
        
        window.recheckDebugServer = () => {
            if (window.debugSystemFixed) {
                return window.debugSystemFixed.recheckServer();
            }
            return false;
        };
        
        console.log('üîç –ì–ª–æ–±–∞–ª—å–Ω—ã–µ debug —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã: getDebugStats(), recheckDebugServer()');
    </script>
</body>
</html>
