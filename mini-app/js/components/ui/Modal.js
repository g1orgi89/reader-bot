/**
 * ü™ü –ë–ê–ó–û–í–´–ï –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê - Modal.js
 * 
 * –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
 * - Backdrop —Å –∑–∞–∫—Ä—ã—Ç–∏–µ–º –ø–æ –∫–ª–∏–∫—É –∏ ESC
 * - –ê–Ω–∏–º–∞—Ü–∏–∏ –ø–æ—è–≤–ª–µ–Ω–∏—è/—Å–∫—Ä—ã—Ç–∏—è
 * - iOS –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–æ–Ω—ã
 * - Telegram Web App –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
 * - –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π
 * - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ —Ñ–æ–Ω–∞
 * - –°—Ç–µ–∫–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–∞–ª—å–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏
 */

class Modal {
    constructor(options = {}) {
        this.options = {
            title: '',
            content: '',
            size: 'medium',           // small, medium, large, fullscreen
            position: 'center',       // center, bottom, top
            backdrop: true,           // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å backdrop
            closeOnBackdrop: true,    // –ó–∞–∫—Ä—ã–≤–∞—Ç—å –ø–æ –∫–ª–∏–∫—É –Ω–∞ backdrop
            closeOnEscape: true,      // –ó–∞–∫—Ä—ã–≤–∞—Ç—å –ø–æ ESC
            autoFocus: true,          // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å
            preventScroll: true,      // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—Ç—å –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Ñ–æ–Ω–∞
            animation: 'fade',        // fade, slide, zoom
            showCloseButton: true,    // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è
            buttons: [],              // –ö–Ω–æ–ø–∫–∏ –≤ —Ñ—É—Ç–µ—Ä–µ
            className: '',            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ CSS –∫–ª–∞—Å—Å—ã
            ...options
        };
        
        this.element = null;
        this.backdrop = null;
        this.isOpen = false;
        this.telegram = window.Telegram?.WebApp;
        this.previousActiveElement = null;
        
        // –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        Modal.stack = Modal.stack || [];
        
        this.init();
    }
    
    /**
     * üîß –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
     */
    init() {
        this.createElement();
        this.attachEventListeners();
    }
    
    /**
     * üé® –°–æ–∑–¥–∞–Ω–∏–µ DOM —ç–ª–µ–º–µ–Ω—Ç–æ–≤
     */
    createElement() {
        // –°–æ–∑–¥–∞–Ω–∏–µ backdrop
        if (this.options.backdrop) {
            this.backdrop = document.createElement('div');
            this.backdrop.className = 'modal-backdrop';
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        this.element = document.createElement('div');
        this.element.className = this.getClasses();
        this.element.innerHTML = this.getContent();
        
        // –ê—Ç—Ä–∏–±—É—Ç—ã –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
        this.element.setAttribute('role', 'dialog');
        this.element.setAttribute('aria-modal', 'true');
        this.element.setAttribute('tabindex', '-1');
        
        if (this.options.title) {
            this.element.setAttribute('aria-labelledby', 'modal-title');
        }
    }
    
    /**
     * üé≠ –ü–æ–ª—É—á–µ–Ω–∏–µ CSS –∫–ª–∞—Å—Å–æ–≤
     */
    getClasses() {
        const classes = ['modal'];
        
        // –†–∞–∑–º–µ—Ä
        classes.push(`modal--${this.options.size}`);
        
        // –ü–æ–∑–∏—Ü–∏—è
        classes.push(`modal--${this.options.position}`);
        
        // –ê–Ω–∏–º–∞—Ü–∏—è
        classes.push(`modal--${this.options.animation}`);
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã
        if (this.options.className) {
            classes.push(this.options.className);
        }
        
        return classes.join(' ');
    }
    
    /**
     * üìÑ –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
     */
    getContent() {
        const header = this.renderHeader();\n        const body = this.renderBody();\n        const footer = this.renderFooter();\n        \n        return `\n            <div class=\"modal__container\">\n                <div class=\"modal__content\">\n                    ${header}\n                    ${body}\n                    ${footer}\n                </div>\n            </div>\n        `;\n    }\n    \n    /**\n     * üì± –†–µ–Ω–¥–µ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–∞\n     */\n    renderHeader() {\n        if (!this.options.title && !this.options.showCloseButton) {\n            return '';\n        }\n        \n        return `\n            <div class=\"modal__header\">\n                ${this.options.title ? `\n                    <h3 class=\"modal__title\" id=\"modal-title\">${this.options.title}</h3>\n                ` : ''}\n                ${this.options.showCloseButton ? `\n                    <button class=\"modal__close\" aria-label=\"–ó–∞–∫—Ä—ã—Ç—å\">\n                        <svg class=\"modal__close-icon\" viewBox=\"0 0 24 24\" width=\"24\" height=\"24\">\n                            <path stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" \n                                  d=\"M18 6L6 18M6 6l12 12\"/>\n                        </svg>\n                    </button>\n                ` : ''}\n            </div>\n        `;\n    }\n    \n    /**\n     * üìÑ –†–µ–Ω–¥–µ—Ä —Ç–µ–ª–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞\n     */\n    renderBody() {\n        return `\n            <div class=\"modal__body\">\n                ${this.options.content}\n            </div>\n        `;\n    }\n    \n    /**\n     * üî≤ –†–µ–Ω–¥–µ—Ä —Ñ—É—Ç–µ—Ä–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏\n     */\n    renderFooter() {\n        if (!this.options.buttons || this.options.buttons.length === 0) {\n            return '';\n        }\n        \n        return `\n            <div class=\"modal__footer\">\n                ${this.options.buttons.map((button, index) => `\n                    <button class=\"modal__button modal__button--${button.variant || 'default'}\" \n                            data-button-index=\"${index}\"\n                            ${button.disabled ? 'disabled' : ''}>\n                        ${button.icon ? `<span class=\"modal__button-icon\">${button.icon}</span>` : ''}\n                        <span class=\"modal__button-text\">${button.text}</span>\n                    </button>\n                `).join('')}\n            </div>\n        `;\n    }\n    \n    /**\n     * üì± –ù–∞–≤–µ—à–∏–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π\n     */\n    attachEventListeners() {\n        // –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è\n        if (this.options.showCloseButton) {\n            const closeButton = this.element.querySelector('.modal__close');\n            if (closeButton) {\n                closeButton.addEventListener('click', () => this.close());\n            }\n        }\n        \n        // –ö–Ω–æ–ø–∫–∏ –≤ —Ñ—É—Ç–µ—Ä–µ\n        const footerButtons = this.element.querySelectorAll('.modal__button');\n        footerButtons.forEach(button => {\n            button.addEventListener('click', (e) => {\n                const buttonIndex = parseInt(button.dataset.buttonIndex);\n                this.handleButtonClick(buttonIndex, e);\n            });\n        });\n        \n        // Backdrop –∫–ª–∏–∫\n        if (this.backdrop && this.options.closeOnBackdrop) {\n            this.backdrop.addEventListener('click', (e) => {\n                if (e.target === this.backdrop) {\n                    this.close();\n                }\n            });\n        }\n        \n        // ESC –∫–ª–∞–≤–∏—à–∞\n        if (this.options.closeOnEscape) {\n            document.addEventListener('keydown', this.handleKeyDown.bind(this));\n        }\n        \n        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω—É—Ç—Ä–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞\n        this.element.addEventListener('click', (e) => {\n            e.stopPropagation();\n        });\n    }\n    \n    /**\n     * ‚å®Ô∏è –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à\n     */\n    handleKeyDown(event) {\n        if (!this.isOpen) return;\n        \n        // ESC –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è\n        if (event.key === 'Escape' && this.options.closeOnEscape) {\n            event.preventDefault();\n            this.close();\n            return;\n        }\n        \n        // Tab –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º\n        if (event.key === 'Tab') {\n            this.handleTabNavigation(event);\n        }\n    }\n    \n    /**\n     * üîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ Tab –Ω–∞–≤–∏–≥–∞—Ü–∏–∏\n     */\n    handleTabNavigation(event) {\n        const focusableElements = this.element.querySelectorAll(\n            'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n        );\n        \n        const firstElement = focusableElements[0];\n        const lastElement = focusableElements[focusableElements.length - 1];\n        \n        if (event.shiftKey) {\n            // Shift+Tab - –Ω–∞–∑–∞–¥\n            if (document.activeElement === firstElement) {\n                event.preventDefault();\n                lastElement.focus();\n            }\n        } else {\n            // Tab - –≤–ø–µ—Ä–µ–¥\n            if (document.activeElement === lastElement) {\n                event.preventDefault();\n                firstElement.focus();\n            }\n        }\n    }\n    \n    /**\n     * üî≤ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ\n     */\n    handleButtonClick(buttonIndex, event) {\n        const button = this.options.buttons[buttonIndex];\n        if (!button) return;\n        \n        // Haptic feedback\n        this.triggerHaptic();\n        \n        // –í—ã–∑–æ–≤ –∫–æ–ª–±—ç–∫–∞ –∫–Ω–æ–ø–∫–∏\n        if (button.onClick) {\n            const result = button.onClick(event, this, button);\n            \n            // –ï—Å–ª–∏ –∫–æ–ª–±—ç–∫ –≤–µ—Ä–Ω—É–ª false, –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ\n            if (result === false) return;\n        }\n        \n        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –∏–Ω–æ–µ\n        if (button.closeOnClick !== false) {\n            this.close();\n        }\n    }\n    \n    /**\n     * üì≥ –í–∏–±—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram API\n     */\n    triggerHaptic(type = 'light') {\n        if (this.telegram && this.telegram.HapticFeedback) {\n            this.telegram.HapticFeedback.impactOccurred(type);\n        }\n    }\n    \n    /**\n     * üîì –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞\n     */\n    open() {\n        if (this.isOpen) return;\n        \n        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç\n        this.previousActiveElement = document.activeElement;\n        \n        // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å—Ç–µ–∫\n        Modal.stack.push(this);\n        \n        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Ñ–æ–Ω–∞\n        if (this.options.preventScroll) {\n            document.body.style.overflow = 'hidden';\n            \n            // iOS viewport fix\n            if (this.telegram) {\n                this.telegram.expand();\n            }\n        }\n        \n        // –î–æ–±–∞–≤–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –≤ DOM\n        if (this.backdrop) {\n            document.body.appendChild(this.backdrop);\n        }\n        document.body.appendChild(this.element);\n        \n        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è\n        requestAnimationFrame(() => {\n            if (this.backdrop) {\n                this.backdrop.classList.add('modal-backdrop--show');\n            }\n            this.element.classList.add('modal--show');\n        });\n        \n        // –§–æ–∫—É—Å\n        if (this.options.autoFocus) {\n            setTimeout(() => this.focusFirstElement(), 100);\n        }\n        \n        this.isOpen = true;\n        \n        // –ö–æ–ª–±—ç–∫ –æ—Ç–∫—Ä—ã—Ç–∏—è\n        if (this.options.onOpen) {\n            this.options.onOpen(this);\n        }\n        \n        // Haptic feedback\n        this.triggerHaptic('medium');\n    }\n    \n    /**\n     * üîí –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞\n     */\n    close() {\n        if (!this.isOpen) return;\n        \n        // –ê–Ω–∏–º–∞—Ü–∏—è –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è\n        if (this.backdrop) {\n            this.backdrop.classList.remove('modal-backdrop--show');\n        }\n        this.element.classList.remove('modal--show');\n        \n        // –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ DOM –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏\n        setTimeout(() => {\n            if (this.backdrop && this.backdrop.parentNode) {\n                this.backdrop.parentNode.removeChild(this.backdrop);\n            }\n            if (this.element && this.element.parentNode) {\n                this.element.parentNode.removeChild(this.element);\n            }\n            \n            // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –µ—Å–ª–∏ —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ\n            Modal.stack = Modal.stack.filter(modal => modal !== this);\n            if (Modal.stack.length === 0 && this.options.preventScroll) {\n                document.body.style.overflow = '';\n            }\n            \n            // –í–æ–∑–≤—Ä–∞—Ç —Ñ–æ–∫—É—Å–∞\n            if (this.previousActiveElement) {\n                this.previousActiveElement.focus();\n            }\n            \n        }, 300); // –í—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–∏\n        \n        this.isOpen = false;\n        \n        // –ö–æ–ª–±—ç–∫ –∑–∞–∫—Ä—ã—Ç–∏—è\n        if (this.options.onClose) {\n            this.options.onClose(this);\n        }\n        \n        // Haptic feedback\n        this.triggerHaptic('light');\n    }\n    \n    /**\n     * üéØ –§–æ–∫—É—Å –Ω–∞ –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç\n     */\n    focusFirstElement() {\n        const focusableElements = this.element.querySelectorAll(\n            'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n        );\n        \n        if (focusableElements.length > 0) {\n            focusableElements[0].focus();\n        } else {\n            this.element.focus();\n        }\n    }\n    \n    /**\n     * üìù –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ\n     */\n    setContent(content) {\n        this.options.content = content;\n        const bodyElement = this.element.querySelector('.modal__body');\n        if (bodyElement) {\n            bodyElement.innerHTML = content;\n        }\n    }\n    \n    /**\n     * üìù –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞\n     */\n    setTitle(title) {\n        this.options.title = title;\n        const titleElement = this.element.querySelector('.modal__title');\n        if (titleElement) {\n            titleElement.textContent = title;\n        }\n    }\n    \n    /**\n     * üî≤ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫\n     */\n    setButtons(buttons) {\n        this.options.buttons = buttons;\n        const footerElement = this.element.querySelector('.modal__footer');\n        if (footerElement) {\n            footerElement.innerHTML = this.renderFooter();\n            this.attachEventListeners();\n        }\n    }\n    \n    /**\n     * üßπ –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤\n     */\n    destroy() {\n        this.close();\n        \n        // –£–¥–∞–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤\n        document.removeEventListener('keydown', this.handleKeyDown.bind(this));\n        \n        // –û—á–∏—Å—Ç–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤\n        this.element = null;\n        this.backdrop = null;\n    }\n    \n    /**\n     * üè≠ –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω\n     */\n    \n    /**\n     * –ü—Ä–æ—Å—Ç–æ–µ –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º\n     */\n    static alert(message, title = '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', options = {}) {\n        return new Modal({\n            title,\n            content: `<p class=\"modal__message\">${message}</p>`,\n            size: 'small',\n            buttons: [\n                {\n                    text: 'OK',\n                    variant: 'primary',\n                    onClick: () => true // –ó–∞–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ\n                }\n            ],\n            ...options\n        });\n    }\n    \n    /**\n     * –î–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è\n     */\n    static confirm(message, title = '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ', options = {}) {\n        return new Promise((resolve) => {\n            const modal = new Modal({\n                title,\n                content: `<p class=\"modal__message\">${message}</p>`,\n                size: 'small',\n                buttons: [\n                    {\n                        text: '–û—Ç–º–µ–Ω–∞',\n                        variant: 'secondary',\n                        onClick: () => {\n                            resolve(false);\n                            return true;\n                        }\n                    },\n                    {\n                        text: '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å',\n                        variant: 'primary',\n                        onClick: () => {\n                            resolve(true);\n                            return true;\n                        }\n                    }\n                ],\n                onClose: () => resolve(false),\n                ...options\n            });\n            modal.open();\n        });\n    }\n    \n    /**\n     * –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Ñ–æ—Ä–º–æ–π –≤–≤–æ–¥–∞\n     */\n    static prompt(message, defaultValue = '', title = '–í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö', options = {}) {\n        return new Promise((resolve) => {\n            const inputId = 'modal-prompt-input';\n            const modal = new Modal({\n                title,\n                content: `\n                    <div class=\"modal__prompt\">\n                        <p class=\"modal__message\">${message}</p>\n                        <input type=\"text\" id=\"${inputId}\" class=\"modal__input\" \n                               value=\"${defaultValue}\" placeholder=\"–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ...\">\n                    </div>\n                `,\n                size: 'small',\n                buttons: [\n                    {\n                        text: '–û—Ç–º–µ–Ω–∞',\n                        variant: 'secondary',\n                        onClick: () => {\n                            resolve(null);\n                            return true;\n                        }\n                    },\n                    {\n                        text: 'OK',\n                        variant: 'primary',\n                        onClick: () => {\n                            const input = document.getElementById(inputId);\n                            resolve(input ? input.value : '');\n                            return true;\n                        }\n                    }\n                ],\n                onClose: () => resolve(null),\n                onOpen: (modal) => {\n                    // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞\n                    const input = document.getElementById(inputId);\n                    if (input) {\n                        input.focus();\n                        input.select();\n                    }\n                },\n                ...options\n            });\n            modal.open();\n        });\n    }\n    \n    /**\n     * Loading –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ\n     */\n    static loading(message = '–ó–∞–≥—Ä—É–∑–∫–∞...', options = {}) {\n        return new Modal({\n            content: `\n                <div class=\"modal__loading\">\n                    <div class=\"modal__spinner\">\n                        <svg class=\"modal__spinner-icon\" viewBox=\"0 0 24 24\">\n                            <circle cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"2\" \n                                    fill=\"none\" stroke-linecap=\"round\" stroke-dasharray=\"31.416\" \n                                    stroke-dashoffset=\"31.416\">\n                                <animate attributeName=\"stroke-dasharray\" dur=\"2s\" \n                                         values=\"0 31.416;15.708 15.708;0 31.416\" repeatCount=\"indefinite\"/>\n                                <animate attributeName=\"stroke-dashoffset\" dur=\"2s\" \n                                         values=\"0;-15.708;-31.416\" repeatCount=\"indefinite\"/>\n                            </circle>\n                        </svg>\n                    </div>\n                    <p class=\"modal__loading-text\">${message}</p>\n                </div>\n            `,\n            size: 'small',\n            showCloseButton: false,\n            closeOnBackdrop: false,\n            closeOnEscape: false,\n            ...options\n        });\n    }\n    \n    /**\n     * –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ\n     */\n    static fullscreen(content, title = '', options = {}) {\n        return new Modal({\n            title,\n            content,\n            size: 'fullscreen',\n            position: 'center',\n            animation: 'slide',\n            ...options\n        });\n    }\n    \n    /**\n     * Bottom sheet –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ\n     */\n    static bottomSheet(content, options = {}) {\n        return new Modal({\n            content,\n            size: 'medium',\n            position: 'bottom',\n            animation: 'slide',\n            ...options\n        });\n    }\n    \n    /**\n     * –ó–∞–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω\n     */\n    static closeAll() {\n        const modals = [...Modal.stack];\n        modals.forEach(modal => modal.close());\n    }\n    \n    /**\n     * –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–µ—Ä—Ö–Ω–µ–≥–æ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞\n     */\n    static getTop() {\n        return Modal.stack[Modal.stack.length - 1] || null;\n    }\n}\n\n// üì§ –≠–∫—Å–ø–æ—Ä—Ç –∫–ª–∞—Å—Å–∞\nwindow.Modal = Modal;