/**
 * iOS/mobile sane fix (unified)
 * - Unified background to avoid white bounce
 * - Fixed bottom nav with safe-area padding
 * - Content bottom padding under nav
 * - Mobile-only "raised" state: top internal strip; icons sit lower and centered
 */

html, body, #app, .app-container, .page-content {
  background: var(--bg-primary);
}

/* Content never overlaps the nav */
.page-content {
  padding-bottom: calc(var(--bottom-nav-height, 60px) + env(safe-area-inset-bottom, 0px));
  min-height: 100dvh;
  overscroll-behavior-y: contain;
  -webkit-overflow-scrolling: touch;
}
@supports not (height: 100dvh) {
  .page-content { min-height: 100vh; }
}

/* Fixed nav base (no transforms on the container itself) */
.bottom-nav {
  position: fixed !important;
  left: 0; right: 0; bottom: 0 !important;
  height: var(--bottom-nav-height, 60px) !important;
  z-index: 1000 !important;
  background: var(--bg-card);
  border-top: 1px solid var(--bg-secondary);
  padding-bottom: env(safe-area-inset-bottom, 0px);
  transform: none !important;
  will-change: auto !important;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}

/* Optional hide via class (e.g., when keyboard is visible) */
.nav-hidden .bottom-nav { transform: translateY(100%) !important; }

/* Mobile-only: raised state with internal top strip; icons move lower */
@media (hover: none) and (pointer: coarse) {
  :root { --nav-raised-strip: 8px; }

  .bottom-nav { position: fixed; }
  .bottom-nav { padding-top: var(--spacing-xs); }

  /* When raised: create an internal top strip and push content down inside the nav */
  .nav-raised .bottom-nav {
    padding-top: calc(var(--spacing-xs) + var(--nav-raised-strip));
  }
  .nav-raised .bottom-nav::before {
    content: "";
    position: absolute;
    top: 0; left: 0; right: 0;
    height: var(--nav-raised-strip);
    background: linear-gradient(180deg, rgba(0,0,0,0.06), rgba(0,0,0,0));
    pointer-events: none;
  }

  /* Ensure nav items sit visually centered below the strip */
  .bottom-nav .nav-item { margin-top: 0; }
}

/* Ensure no unexpected animations on the nav container itself */
.bottom-nav, .bottom-nav::before, .bottom-nav::after {
  animation: none;
}
