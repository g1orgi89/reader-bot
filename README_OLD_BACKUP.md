# üìñ Reader Bot

AI-–±–æ—Ç "–ß–∏—Ç–∞—Ç–µ–ª—å" –¥–ª—è –ê–Ω–Ω—ã –ë—É—Å–µ–ª - –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ —Ü–∏—Ç–∞—Ç —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –∫–Ω–∏–≥.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Reader Bot
```bash
# –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –ë–î –¥–ª—è Reader Bot (–ù–ï –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å Shrooms)
npm run db:setup
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env —Ñ–∞–π–ª —Å –≤–∞—à–∏–º–∏ API –∫–ª—é—á–∞–º–∏
```

### 4. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ Reader Bot
```bash
# Development mode
npm run dev

# Production mode  
npm run start
```

### 5. –î–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ
- **–í–µ–±-—Å–µ—Ä–≤–µ—Ä**: http://localhost:3002
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**: http://localhost:3002/reader-admin
- **API**: http://localhost:3002/api/reader
- **Health check**: http://localhost:3002/api/reader/health

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–æ—Ä—Ç—ã (–ù–ï –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç —Å Shrooms Support Bot):
- **Reader Bot**: 3002 (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä)
- **Shrooms Bot**: 3000 (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä)

### –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
- **Reader Bot**: `reader_bot`
- **Shrooms Bot**: `shrooms_support`

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Reader Bot:
- **RAG –æ—Ç–∫–ª—é—á–µ–Ω** - –Ω–µ—Ç –ø–æ–∏—Å–∫–∞ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
- **–¶–∏—Ç–∞—Ç—ã** - –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram
- **AI –∞–Ω–∞–ª–∏–∑** - —á–µ—Ä–µ–∑ Claude API –±–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## üìñ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
npm run db:check

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Å Telegram –±–æ—Ç–æ–º (webhook mode)
npm start

# Development mode
npm run dev

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤
npm run test:weekly

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
npm run check-health

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
npm run logs
npm run logs:error
```

## ü§ñ Telegram Bot (Webhook Mode)

–ë–æ—Ç —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ webhook, –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —Å –æ—Å–Ω–æ–≤–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º.

**‚ö†Ô∏è –í–∞–∂–Ω–æ**: `bot/start.js` —É—Å—Ç–∞—Ä–µ–ª. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `npm run bot:start` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Webhook

1. **–ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞** –æ—Ç [@BotFather](https://t.me/botfather)

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** –≤ `.env`:
   ```bash
   TELEGRAM_BOT_TOKEN=your_bot_token_here
   ENABLE_SIMPLE_BOT=true
   TELEGRAM_WEBHOOK_URL=https://yourdomain.com/api/telegram/webhook
   ENABLE_REMINDER_CRON=true
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä**:
   ```bash
   npm start
   ```

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç webhook –≤ Telegram
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç ReminderService
- –ó–∞–ø—É—Å—Ç–∏—Ç cron –∑–∞–¥–∞—á–∏ –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π

üìö **–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è**: –°–º. [WEBHOOK_SETUP_GUIDE.md](./WEBHOOK_SETUP_GUIDE.md)

### –§—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞

- **–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞** –≤ Mini App
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- **–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è** (3 —Å–ª–æ—Ç–∞: —É—Ç—Ä–æ, –¥–µ–Ω—å, –≤–µ—á–µ—Ä)
- **Cron –∑–∞–¥–∞—á–∏** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
reader-bot/
‚îú‚îÄ‚îÄ server/              # –í–µ–±-—Å–µ—Ä–≤–µ—Ä –∏ API
‚îú‚îÄ‚îÄ telegram/            # Telegram –±–æ—Ç
‚îú‚îÄ‚îÄ client/admin-panel/  # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
‚îú‚îÄ‚îÄ scripts/             # –°–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ .env                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Reader Bot
```

## üìä –§—É–Ω–∫—Ü–∏–∏

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
- üìù –û–Ω–±–æ—Ä–¥–∏–Ω–≥ —Å —Ç–µ—Å—Ç–æ–º (7 –≤–æ–ø—Ä–æ—Å–æ–≤)
- üí¨ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ü–∏—Ç–∞—Ç —á–µ—Ä–µ–∑ Telegram
- üìä –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã —Å AI-–∞–Ω–∞–ª–∏–∑–æ–º
- üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∫–Ω–∏–≥ –æ—Ç –ê–Ω–Ω—ã
- üèÜ –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:
- üìà –î–∞—à–±–æ—Ä–¥ —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π
- üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- üìñ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ü–∏—Ç–∞—Ç
- üé´ –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- üí∞ UTM –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –ø—Ä–æ–º–æ–∫–æ–¥—ã

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `.env`:

```bash
# –°–µ—Ä–≤–µ—Ä
PORT=3002
MONGODB_URI=mongodb://localhost:27017/reader_bot

# AI
ANTHROPIC_API_KEY=your_api_key
ENABLE_RAG=false

# Telegram
TELEGRAM_BOT_TOKEN=your_bot_token

# –ê–¥–º–∏–Ω
ADMIN_USERNAME=reader_admin
ADMIN_PASSWORD=your_password
```

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "Connection error" / "üçÑ Search failed":
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: `reader_bot`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `ENABLE_RAG=false` –≤ .env
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä: `npm run dev`

### –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–æ—Ä—Ç–æ–≤:
- Reader Bot: –ø–æ—Ä—Ç 3002
- –ï—Å–ª–∏ –ø–æ—Ä—Ç –∑–∞–Ω—è—Ç, –∏–∑–º–µ–Ω–∏—Ç–µ PORT –≤ .env

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
```bash
# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –±–∞–∑—É Reader Bot
npm run db:setup

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
npm run db:check
```

## üìù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
npm test                    # –í—Å–µ —Ç–µ—Å—Ç—ã
npm run test:reports       # –¢–µ—Å—Ç—ã –æ—Ç—á–µ—Ç–æ–≤
npm run test:claude        # –¢–µ—Å—Ç Claude API
```

### –õ–∏–Ω—Ç–∏–Ω–≥:
```bash
npm run lint               # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
npm run lint:fix          # –ê–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `reader_bot` —Å–æ–∑–¥–∞–Ω–∞: `npm run db:setup`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Ä—Ç 3002 (–Ω–µ 3000)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ RAG –æ—Ç–∫–ª—é—á–µ–Ω: `ENABLE_RAG=false`
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏: `npm run logs:error`

---

**üìñ Reader Bot v1.0.0** - –°–æ–∑–¥–∞–Ω–æ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ –ê–Ω–Ω—ã –ë—É—Å–µ–ª